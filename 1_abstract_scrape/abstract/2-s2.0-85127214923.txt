Aiming at the scenario where the energy storage system participates in the grid enhanced frequency response auxiliary service, this research initially constructs a frequency response model to provide power requirements for the energy storage system (ESS). A two-layer optimization approach is proposed to solve the size optimization problem. A mixed-integer linear programming technique is researched on the bottom layer to optimize the power allocation of the hybrid energy storage system (HESS). On the top layer, a size optimization framework is proposed for optimising the configuration of the energy storage system. The size optimization results show that compared with the battery energy storage system (BESS), the capacity of the HESS was reduced by 64%, the battery aging cost was reduced by 52%, and the total cost was reduced by 35%. The results also show that the proposed optimal HESS design could fully leverage the advantages of the battery and the supercapacitor (SC). In addition, the proposed method is investigated in a long-term frequency service case. With the optimal setup and adaptive power distribution approach, both energy storage units operate within the specified power and capacity range at the same time the battery is protected from high-frequency power fluctuations.