Voltage equalization of series-connected supercapacitors (SCs) is of practical significance for the life and security of supercapacitors. In this paper, we proposed an efficient voltage equalization algorithm based on the consensus theory applying for switched shunting resistor circuit of supercapacitor (SC). In the proposed equilibrium strategy, a proportional-integral (PI) observer is designed to estimate the internal capacitance voltage of SCs. Then, by comparing the observation value of internal capacitance voltage with those of its neighbors, the voltages of SCs are balanced before they are fully charged and even after charging is completed. The experiment results show that the proposed method has significant superiority and wider applicability than other exiting methods for equalizing voltage.