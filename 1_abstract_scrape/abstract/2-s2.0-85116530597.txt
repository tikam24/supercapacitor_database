Hybrid energy storage system (HESS) is connected to wind power system with high permeability to smooth power fluctuation and improve wind power consumption in power grid by the duality of source and load. A method for optimal allocation between battery energy storage and supercapacitor energy storage is proposed. Considering the constraints of grid-connected wind power fluctuation, wavelet packet theory is adopted to decompose original output power of wind farm at multiple scales. The amplitude-frequency characteristics of wind power and the performance characteristics of HESS are analyzed comprehensively, and the power and capacity of HESS required are reasonably allocated. According to the state of charge (SOC) of HESS, power commands of battery and supercapacitor are modified by fuzzy control to improve energy storage output level. The annual measured power data from a 100 MW wind farm in north China are used to extract typical daily wind power output of spring, summer, autumn and winter for simulation analysis. Results show that the proposed method can effectively smooth wind power fluctuation, ensure that the SOC of HESS is maintained in a reasonable range, and realize long-term stable and economic operation of the combined wind storage system.