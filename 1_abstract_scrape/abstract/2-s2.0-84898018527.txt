In capacity optimization of hybrid energy storage station (HESS) in wind/solar generation system, how to make full use of wind and solar energy by effectively reducing the investment and operation costs based on the load demand through allocating suitable capacity of HESS is an optimization problem. The optimization objective is to minimize one-time investment and operation costs in the whole life cycle, the constraints are utilization rate, and reliability of power supply. In this paper, mathematical models of wind/solar generation systems, battery, and supercapacitor are built, the objective optimization function of HESS is proposed, and various constraints are considered. To solve the optimization problem, improved simulated annealing particle swarm optimization algorithm is proposed by introducing the simulated annealing idea into particle swarm algorithm. The new algorithm enhance the ability to escape from local optimum and improve the diversity of particle swarm, then help to avoid prematurity and enhance the global searching ability of the algorithm. With the example system, the optimization results show that the convergence of new algorithm is faster than the traditional particle swarm optimization algorithm and its cost optimization is better, which demonstrated the correctness and validity of the proposed models and algorithms. This method can provide a reference for the capacity optimization of HESS in wind/solar generation system. Â© 2010-2012 IEEE.