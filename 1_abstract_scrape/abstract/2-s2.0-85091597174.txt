The intermittence and uncertainty of wind power and photovoltaic power have hindered the large-scale development of both. Therefore, it is very necessary to properly configure energy storage devices in the wind-solar complementary power grid. For the hybrid energy storage system composed of storage battery and supercapacitor, the optimization model of hybrid energy storage capacity is established with the minimum comprehensive cost as the objective function and the energy saving and charging state as the constraints. A simulated annealing artificial fish school algorithm with memory function is proposed to solve the model. The results show that the hybrid energy storage system can greatly save costs and improve system economy.