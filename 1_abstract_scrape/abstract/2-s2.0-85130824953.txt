In conventional low-voltage grids, energy-storage devices are mainly driven by final consumers to correct peak consumption or to protect against sources of short-term breaks. With the advent of microgrids and the development of energy-storage systems, the use of this equipment has steadily increased. Distributed generations (DGs), including wind-power plants as a renewable energy source, produces vacillator power due to the nature of variable wind. Microgrids have output power fluctuations, which can cause devastating effects such as frequency fluctuations. Storage can be used to fix this problem. In this paper, a grid-connected wind turbine and a photovoltaic system are investigated considering the atmospheric conditions and wind-speed variations, and a control method is proposed. The main purpose of this paper is to optimize the capacity of energy-storage devices to eliminate power fluctuations in the microgrid. Finally, the conclusion shows that, in microgrids with supercapacitors, the optimal capacity of microgrid supercapacitors is determined. This method of control, utilizing the combined energy-storage system of the battery supercapacitor, in addition to reducing the active power volatility of the wind turbine and photovoltaic generation systems, also considers the level of battery protection and reduction in reactive-power fluctuations. In the proposed control system, the DC link in the energy-storage systems is separate from most of the work conducted, which can increase the reliability of the whole system. The simulations of the studied system are performed in a MATLAB software environment.