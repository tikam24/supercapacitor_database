As the fossil energy crisis and environmental pollution become more and more serious, clean renewable energy becomes the inevitable choice of energy structure adjustment. The power system planning and operation has been greatly influenced by the instability of the power output of distributed renewable energy systems such as solar energy and wind energy. The hybrid energy storage system composed of accumulator and supercapacitor can solve the above problems. Based on the analysis of the energy storage requirements for the stable operation of the DC microgrid, battery-supercapacitor cascade approach is adopted to form hybrid energy storage system, in a single hybrid energy storage subsystem for battery and supercapacitor and in the microgrid system of different hybrid energy storage subsystem, respectively, and puts forward the corresponding power allocation method to realize the smooth control of the battery current, to reduce the battery charge and discharge times, to prolong the service life of battery and to improve the running stability of the microgrid.