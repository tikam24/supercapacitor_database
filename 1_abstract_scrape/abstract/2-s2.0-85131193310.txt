There is a problem that how to optimize the allocation of hybrid energy storage system (HESS) economically on user-side. To solve this, a planning and scheduling method of HESS considering load smoothing is proposed. Firstly, an optimization model of energy storage system (ESS) considering energy storage life and peak-shaving rate is established, which is used to determine the rated power, rated capacity of ESS, and the charge and discharge power at each moment of the day. Then, this paper constructs a HESS consisting of lead-carbon battery (Pb-C) and supercapacitor. Variational mode decomposition (VMD) algorithm was used to extract peak load. The peak load is smoothed by super capacitor, and the composite load after peak load optimization is smoothed by Pb-C. Finally, solving the optimization model of HESS by mixed integer linear programming (MILP). And the results of the calculation examples show that the optimization method of HESS proposed in this paper not only reduces peak load effectively, but also improves benefits of HESS under the background of time-of-use electricity price.