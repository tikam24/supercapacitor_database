Heteroatom-doped carbon materials are intensively studied in supercapacitors and fuel cells, because of their great potential for sustainably bearing on the energy crisis and environmental pollution. Although enormous efforts are put in material perfection with a hierarchically porous microstructure, the simultaneous optimization of both porous structures and surface functionalities is hard to achieve due to inevitable concurrent dopant leaching effect and structural collapse under required high pyrolysis temperature. In this study, an in situ dehalogenation polymerization and activation protocol is introduced to synthesize nitrogen- and sulfur-codoped carbon materials (NS-PCMs) with hierarchical pore distribution and abundant surface doping, which endows them with good conductivity, abundant accessible active sites, and efficient mass transport. As a result, the as-prepared carbon materials (NS-a-PCM-1000) show an excellent mass specific capacitance of 461.5 F g−1 at a current density of 0.1 A g−1, long cycle life (>23 k, 10 A g−1), and high device energy and power density (17.3 Wh kg−1, 250 W kg−1). Significantly, NS-a-PCM-1000 also exhibits one of the highest oxygen reduction reaction activities (onset potential of 1.0 V vs reversible hydrogen electrode) in alkaline media among all reported metal-free catalysts.