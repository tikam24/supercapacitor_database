Microgrid tends to be an advanced and promising technology in the future smart power supply system, which integrates renewable energy sources under power and energy management. The power management can keep the constant power balance while the energy management can achieve the optimal power flow of a microgrid, where the power prediction should be considered by using the influenced metadata to pre-schedule the power flow of a microgrid. This paper proposes a supervisory system for energy and power management in on-grid/off-grid DC microgrid, which combines sources such as: photovoltaic, storage, public grid connection, diesel generator, and supercapacitor, and supplies a dynamic load. In addition, a load shedding optimization algorithm is proposed to solve the demand response problem. Based on mixed-integer linear programming the energy management layer is used for techno-economic dispatching optimization whereas the power management layer keeps the common DC bus stable. The simulation results, based on real data, prove that: (i) the DC microgrid operates continuously while automatically switching between on-grid/off-grid modes following constraints; (ii) the 24 hours day-ahead power flow optimization achieves a power pre-schedule to decrease the operation cost of the DC microgrid.