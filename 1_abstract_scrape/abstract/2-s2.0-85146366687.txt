Integration of renewable energy sources (RES) and storage systems at a huge scale into our electrical power system can be seen nowadays to meet the power demand. But the high cost of storage and intermittent nature of renewables is a concern for the economical and reliable operation of the microgrid. A dual-layer energy management system (EMS) is presented in this research, along with the degradation cost of the hybrid energy storage system (HESS), which consists of a battery and supercapacitor. The first layer minimizes the total operational expenditure by providing optimal dispatch, the second layer, on the other hand, deals with the fluctuations caused by forecasting error. The proposed EMS is tested for a time-of-use (TOU) pricing scheme and compared with existing techniques. Later it's compared with a different pricing scheme, i.e. a real-time (RT) pricing scheme. From the results, it can be seen that the proposed strategy has better performance which verifies dual-layer EMS effectiveness.