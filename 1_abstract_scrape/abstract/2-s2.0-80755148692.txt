A high penetration rate of the Renewable Energy Sources (RES) can create stability, reliability and power quality problems in the main electrical grid. The microgrid should be a feasible alternative to solve these issues. As it is a weak electrical grid, the microgrid is very sensitive to any variation and consequently an Energy Storage System (ESS) is necessary to reduce their effect. A microgrid needs an ESS with high energy and power densities, but none of the currently available storage technologies satisfies both requirements at the same time. Consequently, it is necessary to associate more than one storage technology creating a Hybrid Energy Storage System (HESS). The objective of this work is to compare by means of simulations three different topologies that are used to control a HESS formed by a SuperCapacitor (SC) bank and a Vanadium Redox Battery (VRB). The compared topologies are the parallel active topology, the floating topology and the Three-Level Neutral Point Clamped (3LNPC) converter topology. The analysed microgrid is formed by the mentioned HESS and different renewable energy sources. This microgrid is interconnected to a weak grid based on a Diesel Generator (DG). Two case studies have been analysed: the effect of the RES while the microgrid is connected to the weak grid and the effect of the disconnection of the microgrid from the weak grid. The different topologies are compared analysing their capability of facing the mentioned variations, their power losses and their Total Harmonic Distortion (THD). The Matlab/Simulink software and the SimPowerSystems toolbox have been used to carry out the simulations. Â© 2011 Elsevier Ltd. All rights reserved.