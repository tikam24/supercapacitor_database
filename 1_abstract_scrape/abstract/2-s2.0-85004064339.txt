In order to absorb the regenerative power and to reduce the peak input power of a train—in other words, to smooth the input power of the train—in this paper we repot a frequency-domain-based power controlling strategy for energy storage of hybrid electric railway vehicles. Applying a loss-compensating method by using a disturbance observer improves the energy while keeping ability of this controller. However, that loss compensating method requires precise voltage–energy characteristics of the supercapacitor (SC) to estimate the correct loss. Hence, nonlinearity of the capacitance of the SC becomes a problem because it causes an error in the estimated loss. Therefore, this paper presents a method to measure the voltage–energy characteristics precisely of the SC that has a voltage dependence on the capacitance. A method to implement those characteristics into controllers is also proposed. The loss compensating method is applied to a controller by using the proposed method, and its effectiveness is verified by a small-scale experimental system. © 2016 Institute of Electrical Engineers of Japan. Published by John Wiley & Sons, Inc.