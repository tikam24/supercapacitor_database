Considering the uncertainty of wind power, a method for determining the capacity of HESS (Hybrid Energy Storage System) is proposed based on spectrum analysis, which makes full use of the complementary advantages of supercapacitor and battery storage, on this basis, the optimal operation strategy of energy storage is proposed. The DFT (Discrete Fourier Transform) is used to decompose the unbalanced wind power to obtain the frequency domain information, and the HESS is used to suppress the unbalanced power. An optimal determination method of cutoff frequency is proposed, and the capacity of the storage battery and super capacitor in HESS is determined. On this basis, the operation strategy model of energy storage based on the opportunity constrained planning is built, which takes the maximum profit as its objective, and the genetic algorithm integrated with Monte Carlo method is used to determine the optimal operation strategy. The validity of the proposed model and method is verified by the analysis of actual data.