An advanced Frequency-Based energy Management (FBM) suitable for Hybrid Energy Storage Systems (HESSs) in Microgrids (MGs) is presented in this paper. The HESS is made up of Batteries (B) and Supercapacitors (S) and it has to provide both peak shaving and power quality. A frequency-based power split criterion is introduced, namely the B power profile is synthesized through an appropriate low-pass filter, while S has to cope with sudden and fast power fluctuations. In addition, in order to enable a suitable peak shaving capability, an appropriate management algorithm is developed based on the forecasted MG power profile. As a result, suitable B power thresholds can be defined in accordance with both B power and energy constraints over a given time horizon. This can be adapted also in real-time in order to benefit from more accurate forecasting and B energy status. The effectiveness of the proposed FBM is proved by numerical simulations, which refer to the MG of the German island of Borkum.