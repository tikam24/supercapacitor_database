The source-load-storage in the DC microgrid takes the form of virtual energy storage, which is easy to improve the operating performance of the system through multi-time-scale energy optimization and coordinated control. Firstly, the charging and discharging characteristics of capacitor energy storage are simulated by wind power and controllable load, and a virtual energy storage system model with multiple flexible resources is constructed and integrated into the DC microgrid. In the optimal dispatch model, the charging and discharging management of the virtual energy storage system is used to complete the economic regulation of the system. Secondly, to deal with unplanned power fluctuations, a two-layer scheduling framework is introduced. Under the premise of ensuring the upper-level energy optimization of economic operation, a short-time source-load-storage zone coordination control is proposed to enhance the reliability of microgrid operation, which is based on virtual energy storage. Finally, the simulations have verified that virtual energy storage can fully stimulate the coordinated regulation potential of the source-load-storage in the DC microgrid under multi-time-scale, and improve the system operation economy and safety.