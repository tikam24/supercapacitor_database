Maximizing carbon capacitance in high-voltage electrolytes has gained increasing interests to resolve the low energy storage concern in supercapacitors. Yet the large ion sizes and high viscosity of such electrolytes greatly thwart their compatibility with the pore diameters of carbon electrodes, leading to sluggish charge transport and unsatisfied energy-power outputs. Herein, heteroatom-doped, hierarchical porous carbons are derived from a high-carbon-yield main-chain poly(ionic liquid) bearing NH2+: HSO4− ion pairs and rigid aromatic backbones, followed by tailoring the 3D porous architecture through alkali ion exchange and in-situ activation. The typical sample (PIL-RbC) has sheet-like geometry, electron-rich N/O heterogeneous dopants, and a vast adsorbing surface (3021 m2 g−1). More importantly, PIL-RbC with ion-matching pores (dominated at 0.80 nm) and ion-transport paths (>1 nm pores) shows a superb compatibility with 1-ethyl-3-methylimidazolium tetrafluoroborate ionic liquid electrolyte, giving a maximized electrode capacitance of 228 F g−1 in a symmetric supercapacitor. The PIL-RbC-based device delivers a high energy density up to 119.4 Wh kg−1 at 397 W kg−1, and maintains 41.7 Wh kg−1 at a high power-output of 19.7 kW kg−1, along with a satisfactory tolerability (91% retention after 10,000 consecutive cycles at 4 V). This strategy sheds light on both synthesizing poly(ionic liquid)-derived heteroatom-doped porous carbons and matching well-designed carbon electrodes with high-potential electrolytes for integrated enhancements in supercapacitor performances.