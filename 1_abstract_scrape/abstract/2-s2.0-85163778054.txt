The article considers the existing methods for calculating the capacitance for energy storage device. Two approaches to choose the capacitance of a supercapacitor for smoothing peak loads are described, energy diagrams and equations are given for both cases. In the approach proposed by the authors, the storage capacity is selected, based on the peak current setpoint, which is consumed from the contact DC power supply. The dependence of the capacitance from peak current is given. An example for determining the capacitance of a supercapacitor module for a frequency-controlled tram electric drive is described. The cost of energy storage devices is calculated. The methods of mathematical modeling confirm the high accuracy of capacitance calculation and illustrate the proposed approach to smoothing peak loads. It is shown that the capacitance of the supercapacitor in the second case is 9 times less, from which it follows that second method has advantages in the mass and price of energy storage device.