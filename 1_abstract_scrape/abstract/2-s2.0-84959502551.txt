Deploying energy storage capacity into microgrid system with distributed generation can improve its reliability and flexibility distinctly. This paper investigates capacity optimization method of energy storage in combined wind-solar microgrid system, considering effects of battery energy storage device operation characteristics on their cycle life. Based on spectrum analysis of net load power, power allocation strategy between battery energy storage and supercapacitor energy storage was proposed. By analyzing cost structure of hybrid energy storage system, the paper established capacity optimization model using minimum annual cost as objective function, charging/discharging power and state of charge as constraints. Results demonstrated that the proposed model is technologically rational and economically efficient. It provides theoretical and technical basis for energy storage planning in standalone microgrid system.