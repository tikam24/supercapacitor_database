The PV-wind-storage microgrid plays an important role in solving power supply problems. Energy storage system is an important element to be considered when the optimal economic operation of microgrid is carried out due to the high cost and discount. To achieve reliable and economic operations of a PV-wind-storage microgrid, the lifetime characteristics of energy storage system also need to be fully investigated. In this paper, low pass filter is used to determine the power of super capacitor and battery, than established battery life quantitative model according to the equivalent cycle life curve. Considering the lifetime characteristics of energy storage system, a optimization to minimize power generation cost and to maximize the useful life of hybrid energy storage system has been achieved via the particle swarm optimization (PSO). The simulation results show the proposed method can optimize the system operations and has good optimization results.