An optimized energy management technique to reduce the cost and increase the effectiveness of a photovoltaic (PV) system is proposed in this paper. It is based on the optimum sizing of the energy storage system, to meet the needs of the system in normal conditions, while in the critical cases, the AC residential load will be supplied by the grid itself. In addition, the surplus of the PV power will be injected to the grid. However, to extend the battery life and reduce its size, a supercapacitor has been combined with the batteries, to quickly respond to the short-time peak current demand, while the battery will deliver a smooth current. Furthermore, the proposed algorithm will supervise the battery state of charge (SOC) and satisfy the highest priority load demand under different situation. A simulation work is carried out to evaluate the control of the whole PV system and determine the performance of proposed algorithm. Finally, the obtained results show the effectiveness of the proposed management algorithm, including the control techniques of different components of the whole system.