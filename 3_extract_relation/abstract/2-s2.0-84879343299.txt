In this paper, a three-phase dynamic voltage restorer and control algorithms are proposed. The compensator detects a voltage sag or interruption within 2-msec delay and provides rated voltage from supercapacitor bank to the critical load. The proposed peak detection method calculates the fundamental and harmonic components by using the discrete Fourier transform, and has a constant detection response regardless of phase angle at which sag occurs. The proposed detection method shows a fast and robust response even under the distorted grid voltage condition, which is polluted by harmonics. During the sag compensation, a new selective harmonic mitigating method for voltage controller is proposed and 5% of THD is achieved even in the nonlinear load. The proposed methods are verified by simulation and experiment with 10kVA DVR prototype. Â© 2013 IEEE.