The unified power quality conditioner (UPQC) has become the most attractive scheme to eliminate the power quality (PQ) problems in the microgrid. To improve the offline and online optimization of UPQC, the simultaneous active and reactive power coordination between the converters of the UPQC has been proposed by utilizing the distributed generator (DG)/supercapacitor (SC) system in the microgrid. For designing the UPQC offline, a multi-objective chance constrained optimization (MOCCO) approach is formulated to obtain the optimal parameters. A Latin hypercube sampling (LHS) based sample average approximation (SAA) method is utilized to solve the MOCCO problem. A corresponding control method is utilized to conduct the online implementation of the proposed UPQC. Moreover, the real-time simulation study verifies the feasibility of the proposed UPQC and the developed control algorithm.