This paper proposes a unified energy management system (EMS) for a grid interactive hybrid microgrid with a hybrid energy storage system (HESS). The proposed EMS achieves a continuous and reliable power supply to local loads and exports/imports power to/from grid. The proposed EMS considers the PV power variations, grid availability, electricity pricing and variations in local loads. A single phase voltage source converter (VSC) transfers real power between DC grid and utility grid and provides ancillary services such as reactive power support, unity power factor and harmonic mitigation at point of common coupling (PCC). The EMS also addresses extreme operating conditions like load shedding, off-MPP operation of PV, critical oscillation of HESS powers, islanded operation and resynchronization with grid. The efficacy of proposed EMS is verified by time-domain simulation.