This article proposes a comprehensive multi-functional controller for a hybrid energy storage system (HESS), including a battery and supercapacitor (SC). In the presented method, a V-dP/dt is proposed to control the output power of the battery converter with a slow dynamic response. The traditional V-P droop is employed to regulate the SC converter to give a fast response. The dc bus voltage can be maintained in a safe range by the SC converter control so that no voltage recovery loop is required. Hence, the order of the overall control system and the complexity of parameter design can be reduced. In addition, a novel consensus-based voltage compensator is proposed to achieve the state of charge (SoC) balance and accurate power sharing among batteries. Then, an SoC restoration of the SC is used to address the leakage current and ensure sufficient energy for future use. Next, a power management scheme (PMS) is proposed to protect the batteries from over-use under different operating modes. Finally, the output impedance characteristics, control system design, and stability analysis are elaborated. The processor in the loop (PIL) simulation results verified the effectiveness and feasibility of the proposed control method.