The operation and control of fuel cell (FC) distributed generation (DG) systems combined with energy storage are studied in this paper. For this purpose, modeling of hybrid FC/energy storage DG system is developed. Dynamic models for proton exchange membrane fuel cell (PEMFC), supercapacitor, DC-DC converters, and grid connected inverter are described. Then a PI controller for the FC converter (boost) and a sliding mode controller for supercapacitor converter (buck-boost converter) are designed to regulate their duty cycles based on the requested current. Moreover, a robust current control strategy for voltage source converter based on positive and negative symmetrical components is presented for treating the unbalance and balance voltage sag conditions. In order to control the power between dc power sources and stabilize the dc-link power during normal and fault conditions, a self-tuning fuzzy control strategy has been designed. This controller determines the supercapacitor power that should be generated according to the amount of available energy in dc-link. The hybrid system is studied under unbalance and balance voltage sag condition. Simulation results are given to show the response of whole system under voltage sag and illustrate the performance including active power control and voltage sag ride-through capability of the proposed control strategy. Â© 2010 John Wiley & Sons, Ltd.