The capacity of an energy storage device configuration not only affects the economic operation of a microgrid, but also affects the power supply's reliability. An isolated microgrid is considered with typical loads, renewable energy resources, and a hybrid energy storage system (HESS) composed of batteries and ultracapacitors in this paper. A quantum-behaved particle swarm optimization (QPSO) algorithm that optimizes the HESS capacity is used. Based on the respective power compensation capabilities of ultracapacitors and batteries, a rational energy scheduling strategy is proposed using the principle of a low-pass filter and can help to avoid frequent batteries charging and discharging. Considering the rated power of each energy storage type, the respective compensation power is corrected. By determining whether the charging state reaches the limit, the value is corrected again. Additionally, a mathematical model that minimizes the daily cost of the HESS is derived. This paper takes an isolated micrgrid in north China as an example to verify the effectiveness of this method. The comparison between QPSO and a traditional particle swarm algorithm shows that QPSO can find the optimal solution faster and the HESS has lower daily cost. Simulation results for an isolated microgrid verified the effectiveness of the HESS optimal capacity configuration method.