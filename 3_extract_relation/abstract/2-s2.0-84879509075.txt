To improve scheduling flexibility of grid-connected Wind and PV power generation system, it is necessary for the system to apply energy storage technology, and the primary key technological problem to be researched is how to determine the capacity configuration of the energy storage system. Using complementary characteristics of the battery and the supercapacitor, an energy management strategy, in which the optimization of battery operating condition is taken as the principle and the improvement of overall economy of energy storage system as the objective, is proposed. Based on the proposed energy management storage, the energy loss rate of grid-connected wind and PV generation system and the calculation course of the rate are analyzed. According to the theory of life cycle cost, the expressions for annual average cost function of energy storage system is established; taking the minimization of this function value as the objective and the loss of produced power probability and the loss of power supply probability as constraints, an optimal configuration model for optimal configuration of the capacity of energy storage system is built. Case calculation is performed by use of improved chaotic optimization algorithm and the built optimization model, and calculation results show that the built optimal modes and the improved algorithm are correct and effective.