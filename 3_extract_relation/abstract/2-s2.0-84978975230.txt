Randomity and fluctuation of wind power is the largest obstacle on large-scale wind power integration. With rapid development of energy storage technology, it becomes an important method solving problem to configure appropriate energy storage system in wind farm. Compared with single energy storage mode, combined configuration of different types of energy storage devices has technological and economic advantage. The paper proposes a wind power fluctuation characteristic index to quantify power output request of wind farm. On basis of wind power fluctuation characteristic index and power dispatching method with variable filter time constant, double-level optimization configuration model of hybrid energy storage system combined with battery and supercapacitor is founded, taking power output request of wind farm and technical and economic requests of hybrid energy storage system as constraints. Nested particle swarm optimization algorithm is adopted to solve the proposed model. Configuration results obtained with the proposed model minimize investment or annually total cost of energy storage system. Case study verifies correctness and effectiveness of the proposed index and optimization model. Effect of variation of characteristic index and energy storage mode and objective function of optimization model on configuration results is discussed.