In the planning of hybrid energy storage in wind farms, considering the service life of the battery in the operation stage, a bi-level optimal configuration method of hybrid energy storage in wind farms considering the service life of the battery is proposed. The upper optimization model takes the optimal energy storage configuration cost as the goal, takes the configuration power and capacity of battery and supercapacitor as variables, and takes the configuration power and capacity of battery and supercapacitor satisfying their respective energy storage power instruction sequence as the constraint condition. The lower optimization model takes the maximum service life of the battery in the running stage as the goal, takes the power instruction sequence of the battery and the super-capacitor as variables, and takes the battery and supercapacitor power instruction sequence not exceeding the limit as the constraint condition. The upper optimization model is solved by the linear programming method, and the lower optimization model is solved by particle swarm optimization algorithm. Finally, the proposed method is compared with the energy storage configuration method based on frequency band demarcation. The results show that the proposed method can reduce the cost of energy storage configuration during planning and prolong the service life of the battery during operation.