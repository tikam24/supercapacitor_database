The ultra-capacitor has high ramp rate and the lithium battery has high energy density, in order to make full use of the complementary performances, to improve the dynamic characteristics and to extend the operating life of energy storage system in DC microgrids, a hybrid energy storage system (HESS) composed of lithium batteries and ultra-capacitors was connected to the DC microgrid. By analyzing the energy storage droop characteristics of ultra-capacitor and lithium battery and the division of operating zone, we proposed an improved coordination control strategy for HESS. Then, according to the power equation of DC microgrid system and the equation about stored energy change of bus capacitor as well as voltage change, we derived the relationship between DC-bus voltage variation and the power flow in the DC microgrid. Thus the voltage hierarchical coordination control strategy was proposed. The experimental results indicate that, using the proposed strategy, the operation of DC microgrid can be divided into five levels according to the variation of voltage. The operation modes of photovoltaic converter, lithium battery converter and ultra-capacitor converter shifting correspondingly with the different levels are determined by detecting the change of the DC-bus voltage, therefore, the corresponding converter to tune the DC-bus voltage and balance the power system in each level is ensured, and the aim of the proposed control strategy is realized. The DC-bus voltage can be adjusted effectively to achieve the power balance of the DC microgrid system by the HESS based voltage hierarchical coordination control strategy.