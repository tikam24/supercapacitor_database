With the increasing demand for energy input from human beings, microgrids have gradually entered a stage of rapid development. In this paper, it proposes a microgrid model composed of a variety of distributed power sources, including photovoltaic cells, batteries and super capacitors. For a variety of distributed power sources, under the corresponding system constraints, a micro-grid economic optimization configuration model including investment costs, annual operation and maintenance costs, and annual purchase and sale of electricity has been established. The particle swarm optimization (PSO) is used to solve the problem, and the convergence effect of the algorithm is analyzed using 4 different types of test functions, and compared with the genetic algorithm (GA) to verify that the algorithm has higher accuracy and efficiency.