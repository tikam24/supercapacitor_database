This paper presents a grid-tied renewable-based microgrid including thermal controllable loads and a hybrid energy storage system based on batteries and a hot water tank. The energy management strategy makes it possible to manage high renewable penetration levels while flattening the power exchanged with the grid. The strategy is validated for a residential application both by simulation and experimental tests carried out during normal operation and under grid failures. Finally, a hydrogen-supercapacitor storage system is analyzed as an alternative to the batteries. The combination of thermal and electric subsystems into an electro-thermal microgrid is a promising technology that can cope with power variations without disturbing the grid. Â© 2013 IEEE.