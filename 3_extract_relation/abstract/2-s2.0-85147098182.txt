In recent years, photovoltaic energy production has experienced significant progress, being integrated into the grid through large-scale distributed systems. The intermittent nature of solar irradiance coupled with the presence of photovoltaic failures causes fluctuations that could compromise the quality and stability of electrical grid. This paper presents a novel photovoltaic power smoothing method in a combination with moving averages and ramp rate to reduce fluctuations with hybrid storage systems (supercapacitors/batteries), the main novelty involves optimizing the number of charging/discharging cycles under PV failures. To achieve this goal, a photovoltaic failure detection method is proposed that uses machine learning to process big data by monitoring the behavior of photovoltaic. The experiments have been done under controlled conditions in the microgrid laboratory of the University of Cuenca. The results show the reduction of the supercapacitor operation with respect to other power smoothing methods. Moreover, the monitoring system is capable of detecting a failure in photovoltaic systems with a root mean squared error of 0.66 and the computational effort is reduced using the new smoothing technique. In this sense, the initial execution time is 4 times lower compared to the moving average method.