Hybrid energy storage system (HESS) is a key component for smoothing fluctuation of power output in microgrid. Appropriate configuration of energy storage capacity for microgrid can effectively improve system economy. A new method for HESS capacity optimization based on statistic model is proposed. The method proposes a power allocation strategy based on spectrum analysis and frequency hysteresis loop control. The strategy coordinates battery and supercapacitor operation and improves battery operation environment. The frequency hysteresis loop strategy extends battery lifetime by reducing charge/discharge period. This method also exploits a sub-algorithms for supercapacitor and battery capacity optimization. Besides, Monte Carlo simulation is implemented to the statistic model to obtain probability distributions of HESS, determining its capacity in different cumulative probability levels. Simulation result verifies rationality and economy of the proposed method.