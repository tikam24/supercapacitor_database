A new approach to determine the capacity of a supercapacitor-battery hybrid energy storage system (HESS) in an independent microgrid is presented. Using empirical mode decomposition technique, the historical non-stationary wind power is firstly analyzed to yield some intrinsic mode functions (IMFs) of wind power. From the instantaneous frequency-time profiles of the IMF, the so-called gap frequency is identified and allows wind power to be decomposed into high and low frequency components. Power smoothing is then achieved by regulating the output power of the supercapacitor and battery to mitigate the high and lower frequency fluctuating components of power respectively. The degree of smoothness of the resulting power delivered to load is assessed in terms of a newly developed level of smoothness (LOS) criteria. A neural network model is utilized to determine the capacity of the HESS through finding a compromise between the cost of the system and the LOS of the power. Simulation results, based on a set of data obtained from a real wind farm, demonstrate the efficiency of the proposed approach.