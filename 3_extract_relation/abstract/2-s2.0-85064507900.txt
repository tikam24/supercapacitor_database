Large-scale wind power grid connection will bring huge challenges to the balance between supply and demand and power quality. It is an effective means to solve the problem by using the hybrid energy storage system composed of battery and super capacitor to stabilize the wind power fluctuation. The imbalanced power is decomposed by wavelet frequency allocation. The component of the imbalanced power corresponding to the high frequency is determined with the grid permitted maximum frequency deviations. Therefore, we propose a wavelet packet optimal decomposition method for imbalance power to separate the high frequency components from the imbalanced power. According to the optimal principle of the energy storage system annual cost, the distribution of imbalance power between different energy storage and the optimized sizing are completed. In order to realize that the states of charge (SOC) of battery and super capacitor are kept in the limitation and they are coordinatively used, the fuzzy control algorithm is adopted to correct the power order to ensure real-time update of the energy storage status and long-term operation of the control strategy. Moreover, a wind farm in an isolated system is taken as an example to verify the effectiveness and economy of the proposed method.