This paper presents a scheme of hybrid power supply system (HPSS) based on on-board energy storage equipment which can recycle the energy of regenerative braking and consequently suppress voltage fluctuation of traction line. Firstly topology of HPSS consisted of power traction grid and on-board energy storage system (ESS) will be presented. Onboard ESS is a combination of super-capacitor (SC) and battery. Energy flow among super-capacitor, batteries and traction line is prudently designed then, in order to improve the power quality of traction power system as well as prolong the lifetime of batteries. Simulations are carried out by Matlab to investigate the impacts of suppressing voltage fluctuation of traction line by on-board ESS. Three scenarios are considered, on-board ESS of SC only with large enough capacity, on-board ESS of SC only with optimized capacity and on-board ESS of combination of SC and battery respectively. Simulation results show that on-board SC is more suitable to effectively suppress voltage fluctuation than battery because of its high power density, while the impact of impact is very limited with the premise of acceptable economy of on-board ESS.