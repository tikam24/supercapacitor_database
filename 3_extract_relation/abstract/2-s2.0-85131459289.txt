Heteroatom-doped microporous carbon nanosheets (HMCNs) are used in a wide range of applications, including gas adsorption, energy storage, and catalysis. Here, we demonstrate a solvent-free, template-free, one-pot polycondensation approach for the synthesis of HMCNs using melamine (MEL) and pentaerythritol (PER) as precursors. By varying the ratio of MEL to PER and the pyrolysis temperature, the doping amount, surface area and porosity of the HMCNs can be controlled. When used for CO2 capture, the HMCN synthesized by the pyrolysis of a 3:2 mixture of MEL and PER at 900 °C (3/2-HMCNs-900) affords a CO2 uptake of 5.35 mmol g−1 at 273 K and 1 bar CO2 partial pressure. Density functional theory calculations suggest that the high CO2 uptake performance of the HMCNs is associated with the chemical modification of the surface, as a result of N- and O- co-doping. When assembled in a supercapacitor, 3/2-HMCNs-900 exhibits a high specific capacitance (475 F g−1 at 1.3 A) and a fast charge-discharge rate of 13.3 F s−1 g−1. This study presents a novel, resource-efficient and environmentally friendly method for preparing HMCNs for energy and environmental applications.