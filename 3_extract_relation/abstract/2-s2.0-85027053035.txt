A voltage source converter (VSC) is incorporated in an active prosthetic leg design. The VSC supplies power to the prosthesis motor and regenerates energy from the prosthesis motor for storage in a supercapacitor bank. An artificial neural network controls the VSC switching so that the prosthesis motor generates a knee torque that matches the torque that is output from a passivity-based controller (PBC). The neural network, PBC, and prosthesis motor parameters are optimized with an evolutionary algorithm to achieve knee angle tracking. Several reference trajectories from able-bodied walking were tracked with an RMS tracking error of less than 0.5Â° while regenerating up to 67 Joules of energy during four gait cycles.