This paper proposes a universal large-capacity capacitor simulator. The proposed simulator consists of a main electrolytic capacitor and three-leg IGBTs. One leg of the IGBTs acts as a bidirectional dc-dc converter. The other two legs are used for a single-phase PWM rectifier. In the capacitor-charging operation, the bidirectional dc-dc converter is used as a boost converter. Most of the power supplied by the load is injected to the utility through the single-phase PWM rectifier. In the capacitor discharging-operation, the bidirectional dc-dc converter acts as a buck converter. Most of the power supplied to the load is from the utility through the single-phase PWM rectifier. A new control method, which can perform an inner-series resistor in a supercapacitor (SC), is also proposed for an SC simulator. The basic principle of the proposed capacitor simulator is discussed in detail. The validity and high applicability of the proposed large-capacity capacitor simulator are confirmed using PSIM software. A prototype experimental model is constructed and tested. Experimental results demonstrate that the proposed capacitor simulator acts both as an ideal large-capacity capacitor and as an SC with an inner-series resistor. Â© 2011 IEEE.