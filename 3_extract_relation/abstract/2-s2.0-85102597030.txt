HESS(Hybrid Energy Storage System) composed of lithium battery and supercapacitor is widely used to smooth the power fluctuation in power system. Low frequency power components are allocated to lithium batteries to give full play to their energy advantages, while high frequency power components are allocated to supercapacitors to give full play to their power advantages. Wavelet transform has the ability of multi-scale decomposition, which can allocate the fluctuating power more reasonably according to the characteristics of energy storage devices. Based on the equivalent time of energy storage device, a method to quantify the frequency characteristics of energy storage devices is proposed. The selection of wavelet basis and the optimization of decomposition level are two critical factors for wavelet transform, which directly affects the decomposition results of fluctuating power. The sum of correlation coefficients, which takes into account both the high and low frequency power components of HESS, is used to select the appropriate wavelet basis. Meanwhile, the relationship between the frequency characteristic of energy storage device and the decomposition level of wavelet transform is established to optimize the decomposition level. Simulative results show that the proposed method can take full advantages of energy storage devices.