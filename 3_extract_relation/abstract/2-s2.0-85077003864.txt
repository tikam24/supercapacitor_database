Currently, using hybrid energy storage system composed of battery and supercapacitor to stabilize DC bus power fluctuation is a hot issue. In low-pass filtering control strategy to suppress the power fluctuation of DC bus, the filtering time constant is fixed, so there are problems such as poor load power fluctuation smoothing effect and over-charge and over-discharge of the battery. In this paper, a two-stage low-pass filter control strategy with variable filter time constant is designed. Firstly, the strategy builds a multi-objective function with minimum load slow target power and DC bus power difference. Using the Improved Particle Swarm Optimisation (IPSO) with compensating coefficient of inertia weight factor to solve the optimal output power by a hybrid energy storage system, and dynamically adjust the first-level filtering time constant, in order to reduce the load power change causing the fluctuation of the DC bus power; secondly, according to the charging state of the supercapacitor and the battery, the fuzzy control method is adapted to dynamically adjust the second-order filtering time constant to optimize the power distribution of the battery and the supercapacitor. The experimental results show that the control strategy can effectively reduce the power fluctuation of DC bus by about 15%, and avoid the over limit phenomenon of the battery state of charge, which has a good prospect of engineering application.