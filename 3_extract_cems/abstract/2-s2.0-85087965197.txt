The uncertainties of electric vehicles travelling and responding have posed challenges for electric vehicles to realize AGC-FM. Therefore, in this paper, the empirical mode decomposition method is adapted to decompose the deviation of thermal power unit frequency modulation into high frequency, medium frequency and low frequency modes, which can be respectively used as the reference output power of the supercapacitor, the battery and the electric vehicle. A user response model of electric vehicle is then established based on the Weber-Feichner law, and the tradeoff between the compensation risk and the profit of the electric vehicles can be realized by introducing the concept of response deviation threshold. To achieve the best AGC FM result and the highest net expectations earnings, a virtual power plant decision- making model is further developed including the thermal power unit, the hybrid energy storage system and the AGC FM electric vehicles. Also, the compensation prices of the electric vehicle in different periods are gained through the improved genetic algorithm based optimization to the configuration of hybrid energy storage system and the output power of each part in the virtual plant. The example results show that this model can significantly improve the effect of AGC frequency modulation, and maximize the expected net income by setting the appropriate response deviation threshold of the electric vehicles.