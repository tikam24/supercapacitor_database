Electrochromic capacitive windows (ECW) combining energy storage and electrochromism have attracted considerable interest because of their unique energy-saving and energy-recovery features. Therefore, it is highly desirable to explore an electrode material with excellent electrochromic and energy storage properties simultaneously. Herein, we synthesize an electroactive polyamide containing pentaaniline segments (EPA) in the main chain via oxidative coupling polymerization, which showcases electrochemical optical modulation and high capacitance synchronously. Attributed to non-acidic electrolyte and rational matching with V2O5 ion-storage material, the as-fabricated ECW exhibits good dual-band optical modulation performance with high optical contrast of 56.57% at 650 nm (Visible region) and 53.29% at 1250 nm (NIR region), fast optical switching response (<5 s), as well as effective regulation of indoor temperature. The resultant ECW also possesses practical energy storage properties, along with a wide voltage window of 2 V, a large capacitance of 47.26 mF/cm2, and outstanding electrochemical cycling durability. In its coloring state, the energy stored in ECW could be utilized to drive small-scale electronic equipment, indicating its energy recovery and reuse feature. In conclusion, the ECW in this work functions as a color-switching smart window and a rechargeable supercapacitor, which exhibits great promise for development in green buildings.