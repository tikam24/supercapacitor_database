Microgrid is an effective approach to accommodate renewable energy. This paper analyzes the operating principle of Hybrid Energy Storage System (HESS) and proposes a method to manage the power among generators, loads and HESS based on the PI controller. Finally, it shows the simulation system of DC coupled hybrid microgrid, and test it by changing the load demand and output power of distributed generator to observe the work process of HESS.