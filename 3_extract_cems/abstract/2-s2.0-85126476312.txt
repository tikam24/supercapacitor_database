The wind power has its own intermittent and fluctuating characteristics, which affects the stable operation of the power grid. In order to reduce the influence of wind power fluctuation on the grid, this paper aims at suppressing wind power fluctuation, and constructs a dual level programming model of hybrid energy storage suppressing wind power fluctuation and determining capacity, which is based on multi-step model algorithm control (MAC). The upper model takes the minimum output of energy storage and the balance of storage charge and discharge as the objective function, and uses MAC to solve the total scope of hybrid energy storage, then, an adaptive sliding window adjustment method considering hybrid energy storage economy is proposed. The total scope is decomposed into battery scope and supercapacitor scope by moving average filter (MAF), which makes the super capacitor act on the part with large change rate of control sequence, and the battery acts on the smooth part of control sequence. Based on MAC-MAF scope, the energy storage operation strategy is formulated. According to the upper solution results and the energy storage operation strategy, the optimal ratio model of the capacity of the lower super capacitor and the battery is established. The model takes the lowest daily operating cost of the hybrid energy storage system as the objective function, the multi-objective Harris Eagle algorithm is used to solve the above model. The rationality of the proposed strategy and the effectiveness of the model solution method are verified by a 50MW wind farm in Xinjiang.