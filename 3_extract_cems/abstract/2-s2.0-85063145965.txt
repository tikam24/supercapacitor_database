In order to improve the power quality and economic benefits of independent scenery hybrid system, energy storage technology needs to be introduced, and the key technical issue of energy storage technology research is the capacity allocation of energy storage system. In this paper, a mathematical model of battery and super-capacitor is established firstly. Based on the complementary characteristics of battery and super-capacitor, a capacity optimization strategy of the hybrid energy storage system is proposed. Based on this strategy, the improved particle swarm optimization algorithm is taken to optimize the capacity of the independent wind-solar hybrid power generation system with loss of power supply probability (LPSP) and loss of produced power probability (LPPP) as the system operation index. At the same time, the capacity optimization configuration model with the constraint of the reliability index of LPPP and LPSP of independent wind and solar hybrid power system is established with the objective of full life cycle cost of hybrid energy storage device. Aiming at the problem of insufficient local search ability and easy falling into local optimum of particle swarm optimization algorithm, an improved particle swarm optimization algorithm is proposed to solve this optimization problem. The results of the example analysis show that the optimization model and the improved algorithm are correct and effective.