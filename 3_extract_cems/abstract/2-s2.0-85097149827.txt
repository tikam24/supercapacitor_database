This paper aims to optimize the cost of a battery and supercapacitor hybrid energy storage system (HESS) for dispatching solar power at one-hour increments for an entire day for megawatt-scale grid-connected photovoltaic (PV) arrays. A low-pass filter (LPF) is utilized to allocate the power between a battery and a supercapacitor (SC). The cost optimization of the HESS is calculated based on the time constant of the LPF through extensive simulations in a MATLAB/SIMULINK environment. Curve fitting and Particle Swarm Optimization (PSO) techniques are implemented to seek the optimum value of the LPF time constant. A fuzzy logic controller as a function of battery state of charge is developed to estimate the grid reference power for each one-hour dispatching period. Since the ambient temperature and PV cell temperature are different, this study also considers the relationship between them and presents their effects on energy storage cost calculations.