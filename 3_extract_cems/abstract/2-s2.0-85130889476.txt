The increasing integration of renewable energy sources (RESs) poses challenges of active power balance in both the normal operating states and contingencies. The hybrid energy storage system (HESS) consisting of the battery and supercapacitor is flexible, and can provide additional regulation capability. This paper proposes an optimal sizing scheme for the HESS considering power smoothing in steady-state operation and transient frequency regulation after disturbances. First, the output power of RESs is decomposed by the discrete wavelet transform, and the low- and high-frequency fluctuations are separately allocated to the battery and supercapacitor for smoothing. Then, an extended system frequency response model is developed for estimating the required transient frequency regulation capability (TFRC) of the HESS to arrest frequency excursion in contingencies. Furthermore, taking into account the fluctuation smoothing, required TFRC and investment cost, a multi-objective optimization model is established to optimize the size of the HESS. Additionally, the linear weighted method and generalized Benders decomposition are utilized to divide the optimization model into two stages, where a master problem and two subproblems are solved iteratively. A case study is conducted to validate the proposed scheme, showing high cost efficiency, and superior performance in smoothing power fluctuation and improving frequency nadir.