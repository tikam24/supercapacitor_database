In order to optimize the capacity dispatch of energy storage system in grid-connected wind-solar hybrid power generation system, a method for optimizing the capacity of hybrid energy storage system composed of supercapacitors and batteries in grid-connected wind-solar hybrid power generation system is proposed by utilizing the generation data of wind power and photovoltaic and the dispatch data of power grid. Based on the method of Particle Swarm Optimizer (PSO), it was simulated that wind-solar hybrid power joined into the dispatch according to the rules of dispatch system. The best power dispatch was achieved by multi-objective particle swarm optimization (MPSO). The results show that the accuracy of capacity optimization of energy storage system can be improved by considering both the total continuous power loss and the instantaneous power loss. The hybrid energy storage system composed of supercapacitors and batteries can improve the overall security and economy of the power grid.