Heteroatom-doped hierarchically porous carbon is attractive electrode material for supercapacitors. However, it still remains a great challenge to develop a high-performance supercapacitor electrode with efficient preparation strategy. Herein, we report a N,O-codoped hierarchically porous carbon (NOHPC) prepared through one-step carbonization/in-situ doping/activation process by using natural diatomite as template and polydopamine as precursor. The as-prepared NOHPC possesses synergistic advantages of abundant redox-active N,O dopants, large effective specific surface area and hierarchically porous (micropores, mesopores and macropores) structure. Benefiting from such advantages, the NOHPC electrode exhibits an extremely high specific capacitance of 436.0 F g−1 at 0.625 A g−1 in H2SO4 electrolyte. The as-assembled supercapacitor in H2SO4 electrolyte also yields high specific capacitance (328.3 F g−1 at 0.625 A g−1), excellent rate performance (74.8% capacitance retention, 0.625–25 A g−1) and superb cycling stability (93.9%, 10,000 cycles). Besides, the corresponding device in Na2SO4 electrolyte can present an enhanced energy density of 23.4 Wh kg−1 at the power density of 358.8 W kg−1 (1 A g−1) and still maintain 15.0 Wh kg−1 at the power density of 8357.8 W kg−1 (25 A g−1). The outstanding electrochemical performance and the efficient preparation process of NOHPC make it a promising widely applied electrode material for supercapacitor.