Under the traditional droop control, the hybrid energy storage system can not reasonably distribute the power according to the energy storage characteristics and dynamic response of the battery and supercapacitor. At the same time, the existence of single-phase inverter load leads to the generation of second harmonic current in the front-stage converter and the input source, which will shorten the service life of the system and destroy the stable operation of the system. To solve the above problems, a power division coordination and low-frequency harmonic current suppression strategy based on composite virtual impedance is proposed in this paper. Under the action of composite virtual impedance, the low-frequency and high-frequency equivalent output impedance of the system are dominated by the impedance of the battery side and the supercapacitor side, respectively. At this time, the battery provides the low-frequency component of the system power fluctuation and suppresses the DC bus voltage fluctuation to stabilize the system energy supply and demand balance. The supercapacitor quickly absorbs the high-frequency component of system power fluctuation and improves the dynamic response of the system. On this basis, it is analyzed that the composite virtual impedance enables the inductance branch to show a high impedance at the double output frequency, and to show a low impedance outside the double output frequency, so as to suppress the second harmonic current. Finally, the effectiveness of the proposed method is verified by experiments.