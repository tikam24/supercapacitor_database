In this paper, real-time operation and harmonic analysis of isolated and non-isolated DC microgrid including hybrid energy sources and various loading schemes is investigated. The proposed microgrid is supplied by an internal generator and via AC grid, while a supercapacitor bank, as power buffer, fulfills the high power requirement of the DC grid. An energy management algorithm based on the master-slave control is proposed, in which the supercapacitor bank, as the master, control the DC bus voltage while the other units are working in current control to share the required power. Different operation mode based on various power sharing patterns is defined and the experimental test is carried out for both isolated and non-isolated DC grid. Results show that the proposed energy management algorithm properly shares power and control the voltage. Moreover, the isolation of the DC microgrid highly effect on the harmonic content of the current depending on the power sharing pattern. Â© 2013 IEEE.