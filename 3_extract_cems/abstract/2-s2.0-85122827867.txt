Due to their environmental protection and high power generation efficiency, the control technology of hydrogen fuel cells (HFCs) connected to the microgrid has become a research hotspot. However, when they encounter peak demand or transient events, the lack of power cannot be compensated immediately by HFCs which results in sudden changes of the voltage and frequency. The improved virtual synchronous generator (VSG) control strategy based on HFCs and supercapacitors (SCs) combined power generation system is proposed to overcome this shortcoming in this paper. The small-signal model for designing the combined system parameters is provided which are in accordance with the system loop gain, phase angle margin, and adjustment time requirements. Besides, the voltage and current double closed-loop based on sequence control is introduced in the VSG controller. The second-order generalized integrator (SOGI) is utilized to separate the positive and negative sequence components of the output voltage. At the same time, a positive and negative sequence voltage outer loop is designed to suppress the negative sequence voltage under unbalanced conditions, thereby reducing the unbalance of the output voltage. Finally, simulation results in MATLAB/Simulink environment verify that the proposed method has better dynamic characteristics and higher steady-state accuracy compared with the traditional VSG control.