Nickel oxide (NiO) is a promising candidate for future electrochromic supercapacitors due to its pronounced electrical properties and low cost. Unfortunately, the weak interaction between NiO films and conductive substrates results in poor cycling stability. In addition, the long color-switching time and low capacitance by the small lattice spacing in dense NiO impede its practical applications seriously. Herein, a hierarchical porous NiO film/ITO glass bifunctional electrode has been prepared via the solvothermal and subsequent calcination process of growing MOF-74 in situ on ITO, which shows outstanding cycle reversibility, excellent capacitance, high coloration efficiency and short color-switching time. Because of the strong binding force between the NiO film and substrate, and large surface areas with a hierarchical porous structure which are beneficial to the ion transport, the NiO film demonstrates perfect capacitive and electrochromic properties. As a bifunctional electrode, the NiO film shows a specific capacitance of 2.08 F cm-2 at 1 mA cm-2, large optical modulation of 41.08% and about 86% of optical modulation retention after 10,000 cycles. Furthermore, we assembled a bifunctional device whose energy condition can be roughly estimated according to the color state of the device. This finding can provide us with a new application of MOFs in the dual device of electrochromic supercapacitors.