In this paper a voltage regulation controller based on active disturbance rejection control (ADRC) is proposed for hybrid energy storage system (HESS), which consists of batteries and supercapacitors, in photovoltaic dc-microgrid. The total current reference of storage systems is generated by the ADRC voltage controller and allocated to each storage device via a low-pass filter. A nonlinear extended state observer (ESO) is designed to calculate the value of the estimated dc bus voltage and total disturbances. Then the dynamic compensation of current reference can be achieved. Simulations are conducted to validate the robustness and rapidity of the proposed method and the results are compared with traditional double loop PI controller. The comparison results demonstrate that the new controller has higher dynamic performance and better anti-disturbance capability.