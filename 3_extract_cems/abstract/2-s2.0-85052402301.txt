In order to achieve the purpose of simultaneously compensating for active power and reactive power during voltage sags in the distribution network, a Buck/Boost bidirectional converter is used to connect the supercapacitor energy storage device and the static synchronous compensator. The system adopts voltage and current double closed-loop control method. According to Matlab/Simulink, the relevant simulation experiments show that the supercapacitor has constant voltage on the DC bus side whether it absorbs electric energy or releases.