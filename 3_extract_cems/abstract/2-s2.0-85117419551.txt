One of the significant challenges toward utilizing hybrid energy storage systems (HESSs) in microgrids (MGs) is the accurate sizing of the storage devices. This article developed an effective method that evaluates battery lifetime's impact on the optimal size of a HESS considering the total cost function minimization. Therefore, high-frequency powers are provided by supercapacitor (SC), and the battery provides low-frequency power. Besides, implementing discrete Fourier transform (DFT) and the particle swarm optimization (PSO) algorithm is also proposed to achieve optimal HESS sizing in MG. The difference between power generation and load consumption is transferred to the frequency domain, and after determining the cut-off frequency, the optimized cost function is obtained. The suggested sizing strategy has been validated with actual data of solar radiation, wind speed, and load profile on an MG. Compared to just utilizing battery storage, the system's total cost is decreased by employing the proposed HESS configuration, and its dynamic performance is improved by allocating high-frequency power to the SCs. Considering the battery lifetime, it would be observed that implementing HESS will reduce the total storage costs compared to the conventional method in which just one type of energy storage—such as a battery—is used. The load's response time will also be faster since the supercapacitor is a high power density energy storage, and it will provide a faster and proper response for nonlinear and pulsed loads. Lastly, using HESS systems for pulsed and nonlinear loads will reduce storage costs by increasing battery lifetime and improving load response.