Using supercapacitor store surplus regenerative braking energy in urban rail transit traction power supply system can achieve good effects on energy efficiency and voltage regulation. Firstly, the traction power supply system characteristics and train braking characteristics are analyzed. Then the model of supercapacitor energy storage system based on bidirectional Buck/Boost converter is established. Combing with voltage-current double closed loop control strategy, the influence of grid voltage and duty cycle on dynamic performance of the system is discussed. The relationship between the inner loop gain and grid voltage, and the relationship between the outer loop gain and duty cycle are discussed. Based on this, the control strategy of variable gain is proposed, which can offset the influence of grid voltage and duty cycle on dynamic performance of the system by changing the gain of inner loop and outer loop, making the system maintain good dynamic performance when the parameters variation in a wide range. Finally, the effectiveness of the proposed control strategy is verified by simulation.