The operation of a photovoltaic (PV) generating system under intermittent solar radiation is a challenging task. Furthermore, with high penetration levels of photovoltaic energy sources being integrated into the current electric power grid, the performance of the conventional synchronous generators is being changed and grid inertial response is deteriorating. This paper proposes a combined virtual inertia emulator (VIE) and a hybrid battery-supercapacitor-based energy storage system for enhancing the stability of the Microgrids and smoothing the short-term power fluctuations simultaneously. Not only could the suggested system overcome the slow response of battery system (including dynamics of battery, controller, and converter operation) by redirecting the power surges to the supercapacitor system, but also enhance the inertial response by emulating the kinetic inertia of synchronous generator. Control systems for the VIE and battery-supercapacitor storage system are presented in this paper. Correspondingly simulation results are discussed to validate the effectiveness of the proposed scheme. In this paper, Matlab Simulink software has been considered to develop control designs of VIE and Hybrid Energy Storage System (HESS). Through these studies, it will be demonstrated that the recommended method is capable of achieving voltage and frequency regulation and effective management of the hybrid storage system. Since the suggested technique focuses on short-term fluctuations and includes no long-term power regulation, it needs no mass storage device. Thus, the method is economical. The other concerns raised by renewables (e.g., forecast accuracy, low voltage ride-through, etc.) have not been addressed within this study.