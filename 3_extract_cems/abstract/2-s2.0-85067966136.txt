In order to recover the regenerative braking energy generated by AC locomotive and improve the power quality of traction power supply system, a back-to-back hybrid energy storage system (HESS) and its control method were proposed. Firstly, the energy distribution relationship and optimal compensation mechanism were analyzed theoretically. Then, a composite optimization control method was set up, which includes the allocation strategy of target output values of HESS, optimal compensation mathematical model of converter with power quality parameter constraints, and internal coordination control strategy of HESS with dynamically adjusting the limiting power. Finally, based on the given working conditions and typical daily measured load data of a traction substation, the simulation analysis and verification were carried out from the following aspects: power flow distribution, power quality improvement, operational condition of battery and supercapacitor, braking power recovery with different mixing degree of HESS. The results show that, the system and its control method can achieve the multi-directional transfer, storage and release of energy on demand, which realizes the reasonable utilization of regenerative braking energy. Moreover, it can effectively reduce the sequence current of system side and improve the average power factor. The reasonable power distribution between battery and supercapacitor is beneficial to improve the power supply reliability and long-term operation ability of HESS.