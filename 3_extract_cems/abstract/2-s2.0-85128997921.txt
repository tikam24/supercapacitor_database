With increasing concerns on transportation decarbonization, fuel cell hybrid trains (FCHTs) attract many attentions due to their zero carbon emissions during operation. Since fuel cells alone cannot recover the regenerative braking energy (RBE), energy storage devices (ESDs) are commonly deployed for the recovery of RBE and provide extra traction power to improve the energy efficiency. This paper aims to minimize the net hydrogen consumption (NHC) by co-optimizing both train speed trajectory and onboard energy management using a time-based mixed integer linear programming (MILP) model. In the case with the constraints of speed limits and gradients, the NHC of co-optimization reduces by 6.4% compared to the result obtained by the sequential optimization, which optimizes train control strategies first and then the energy management. Additionally, the relationship between NHC and employed ESD capacity is studied and it is found that with the increase of ESD capacity, the NHC can be reduced by up to 30% in a typical route in urban railway transit. The study shows that ESDs play an important role for FCHTs in reducing NHC, and the proposed time-based co-optimization model can maximize the energy-saving benefits for such emerging traction systems with hybrid energy sources, including both fuel cells and ESD.