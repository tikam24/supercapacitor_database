In a hybrid energy storage system, batteries play an important role to store and release energy when it is required. Because batteries are very expensive, increasing their life cycles has a paramount importance in cost justification of the energy storage systems. However, current fluctuations reduce normal life cycles of batteries. As a remedy, supercapacitors are adopted to reduce the current fluctuations to smooth battery's current. Recently, researchers have attempted to minimize the batteries' current fluctuations by controlling the supercapacitor's current and/or voltage, with a limited reported success. This letter proposes an enhanced approach to reduce batteries' current fluctuations and to minimize energy lost for residential applications, by controlling the supercapacitor's voltage using two optimization stages: 1) predictive reference voltage determination and 2) online voltage adjustment. The proposed method has been evaluated using simulated and real data, and results validate the superiority of the proposed method compared to the state-of-the-art.