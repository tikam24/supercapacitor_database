For distributed heterogeneous energy storage systems (HESSs) in a dc microgrid, a virtual impedance droop (VID) control, composed of virtual resistance droop control and virtual capacitor droop control, can realize low- and high-frequency power sharing between a battery and supercapacitor (SC) automatically. However, it still suffers from voltage deviation. In this paper, a secondary voltage recovery (SVR) control is proposed for a battery and SC on the basis of VID control. The SVR control for batteries is designed to regulate the average bus voltage to the reference value, depending on the communication between neighboring batteries. Nevertheless, the SVR control for SCs is decentralized to facilitate fast recovery of the state of charge, in spite of the existence of leakage current. Detailed impedance characteristics analysis and small-signal stability analysis are performed to find that the proposed SVR control does not affect the power sharing dominated by the primary VID control and the system stability. Simulations for both a single HESS and multiple HESSs are conducted to verify the effectiveness of the proposed control strategy.