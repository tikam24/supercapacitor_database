This paper presents a switching bi-directional buck-boost converter (SBBBC) for vehicles-to-grid (V2G) system. The topology can provide an energy bi-directional flow path for energy exchange between the Li-battery/supercapacitor (SC) hybrid energy storage system (HESS) of the electric vehicle and the grid. This topology not only has buck-boost capability, but also has the function of energy management. In this paper, the state-space averaging method is used to analyze the stability of the topology in boost and buck modes. The control strategy is given according to the state of charge (SOC) of the energy storage system to ensure that the output voltage and current are stable. And the Li-battery is charged in constant current (CC) and constant voltage (CV) mode. The voltage and current controllers are designed in the frequency domain based on bode plots. Finally, the electrical feasibility of the topology, the suitability of the design controller and control strategy are verified by simulation and experiment.