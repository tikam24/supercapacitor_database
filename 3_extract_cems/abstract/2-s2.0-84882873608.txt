The proper operation of a microgrid requires storage devices that increase the inertia and avoid instability of the system. This paper presents the control of an energy storage system (ESS) based on supercapacitors in the context of grid-connected microgrids. The ESS is composed of ac/dc and dc/dc converters tied by a dc link. A single sliding mode strategy is proposed to control a bidirectional dc/dc converter, capable of working properly under all operating conditions. The switching devices are commanded by a single sliding function, dynamically shaped by references sent from the microgrid central controller. This feature facilitates the implementation and design of the control law and simplifies the stability analysis over the entire operating range. The effectiveness of the proposed control strategy is illustrated by experimental results. Â© 1986-2012 IEEE.