The microgrid power plant contains a large number of power electronic converters, which inevitably produce power quality problems such as harmonic noise and voltage fluctuations. Harmonics noise is produced excessive heat and reduce the life of the equipment. In this paper, the control strategy of a combination of the bidirectional DC/DC and DC/AC device to integrate supercapacitor and Active Power Filter is proposed. The detail of the mathematical model of the working principle of combination and analyzes the structural characteristics and the switching modes of power regulation and harmonic control logic is provided. The simulation results show that the combined device can perform the functions of power smoothness, reactive power compensation and harmonic control according to the needs, which verifies the rationality and effectiveness of the combined equipment operation.