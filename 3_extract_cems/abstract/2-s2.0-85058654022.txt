A hierarchical distributed control structure is proposed for the optimal operation of a hybrid energy storage array system (HESAS) composed of multiple battery units and supercapacitor units. A grouping control strategy is established for multiple battery units. The upper layer is the coordinated control layer. To realize the coordinated and safe operation of a battery energy storage system (BESS) and supercapacitor energy storage system (SCSS), a two time-scale optimization model based on model predictive control (MPC) is proposed. The long time-scale model provides reference values for the short time-scale model, whereas the short time-scale model optimizes the real-time power demand based on the reference values to ensure that the state of charge and power of the BESS and SCSS are within the safe operation region. The lower layer is the distributed control layer. To quickly decompose the power commands sent by the upper layer, the weighted discrete consensus algorithm based on MPC is used to realize the adaptive allocation of power between the units with the same energy storage. The convergence speed of the proposed algorithm is improved by shrinking the weighted matrix. The results show that the proposed control structure, model, and grouping strategy have certain advantages in terms of control performance, convergence speed, and in extending battery life.