A series of carbon precursors were obtained via the co-thermal dissolution of coal and wheat straw (WS) with different weight ratios. Three-dimensional hierarchical porous carbon (HPCX) materials were prepared from the carbon precursors. Among the porous carbon materials, HPC1/3 (WS:coal = 1:3 in weight) showed a specific capacitance of 384 F g-1 at 1 A g-1 in 6 M KOH and a good retention capability of 92% at a current density of 10 A g-1. A symmetrical supercapacitor was further fabricated using HPC1/3 for both electrodes. The supercapacitor exhibited an excellent cycle lifetime, retaining 98% of specific capacitance after 10 000 cycles. The excellent electrochemical performance of HPC1/3 is closely related to the corresponding composition of the carbon precursor. Gas chromatography/mass spectrometry and Orbitrap mass spectrometry were used to reveal the detailed composition of carbon precursors at the molecular level. The N-containing and O-containing compounds in carbon precursors are helpful for the enhancement of capacity, surface polarity, and electrical conductivity. Aromatic compounds with a high unsaturation in a carbon precursor contribute to the high specific capacitance and cycling stability.