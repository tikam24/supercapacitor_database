A hierarchical structure energy storage (ES) system for photovoltaic (PV) power generation is proposed to make the most use of various kinds of ES devices and reduce cost. The ESs with quick response speed like supercapacitor is used to smooth the variations of PV power; the ESs with large capacity like battery is used to reduce peak and fill valley. The power fluctuations of PV in multiple regions are divided into different frequency segments for stabilization. The system can operate with or without AC grid support. The paper also proposed a protection strategy that adjust the charging or discharging power of the battery in real time with consideration of its state of charge (SOC) and the power limit. The proposed protection strategy ensures the power system security and stability.