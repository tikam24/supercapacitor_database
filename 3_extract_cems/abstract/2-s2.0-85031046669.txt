The battery/supercapacitor hybrid energy storage system has become one of the future development directions for energy storage technology by combining the advantages of high power density and high energy density. According to the application demand for stabilizing DC bus voltage fluctuation of the microgrid, the battery/supercapacitor hybrid energy storage system is studied, and the equivalent circuit model of hybrid energy storage system is established. In order to fully guarantee the overall performance of the hybrid energy storage system, a master-slave dual-loop structure adaptive control strategy is proposed. The hybrid energy storage system can produce adaptive response to the output power fluctuation according to the different cut-off frequencies of the system. And the upper level of the power adjustment is completed and balanced. To solve the problem of difficulty in measuring the load current, virtual measurement based on the extended state observer is proposed. Simulation results have verified the effectiveness and feasibility of the proposed control strategy.