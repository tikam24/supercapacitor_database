Based on power demand of users and renewable energy generation situation, in this paper, a hybrid energy storage system consisting of gravity energy storage, battery and supercapacitor is proposed, and the mathematical modelling of the hybrid energy storage system is established. According to different characteristics, a strategy of optimal capacity configuration of hybrid energy storage system based on adaptive variational mode decomposition is proposed and the optimal configuration model of hybrid energy storage capacity is sowed. The optimal energy storage system's decomposition scale K, the frequency demarcation points and their corresponding energy storage configuration are verified on typical daily output data of a wind-solar generation station. It is indicated that the results reflect the economy and rationality of the proposed method.