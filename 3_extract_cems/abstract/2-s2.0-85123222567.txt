In this paper, we propose a new decentralized control and power-sharing strategy to manage the power flow among energy sources (ESs), energy storage systems (ESSs) and the common dc-link. In the proposed technique, we eliminate all communication among the ESSs, to reduce the complexity and increase reliability, maintaining dc-link voltage restoration. In this context, batteries and ultracapacitors (UCs) are the ESSs, while ESs can be any power source such as photovoltaic, wind, fuel-cell and etc. This technique shares the microgrid power imbalance between batteries, proportionally to their state-of-charge (SoC) and energy capacity, achieving SoC equalization. The technique also promotes voltage restoration for the UCs, keeping their average voltage constant after supplying the power peaks during power transients. For all ESSs only local variables are measured, such as local current and dc-link voltage, with no shared data between ESSs. Small signal and stability analysis are performed, along with experimental results in a lab bench show the feasibility and performance of the technique.