With the rapid development of electrified railway, the demand for energy is increasing day by day. It is urgent to promote the coupling interconnection of railway, new energy and energy storage, and promote the low-carbon and green development of railway. Therefore, this paper proposes a topology and control strategy of photovoltaic microgrid with hybrid energy storage system (HESS) connected to electrified railway traction power supply system (TPSS), which can recover regenerative braking energy while realizing PV energy consumption, and comprehensively compensate the TPSS for reactive power, negative sequence and harmonic. Firstly, the topology and control method of subsystem are studied, and the traditional railway power conditioner (RPC) control strategy is improved to enable PV and HESS to connect to the TPSS; Then, according to different operating states, the HESS energy distribution strategy based on SOC value is proposed, the principle of “shallow charge and shallow discharge” is implemented for the battery, and the limiting power dynamic distribution control strategy of battery and supercapacitor is proposed; Finally, the proposed model and control strategy are established in Matlab/Simulink, and four typical working conditions are simulated to prove the effectiveness and feasibility of the proposed topology and control strategy. The results show that photovoltaic power can provide part of the required power of the traction load and can recover regenerative braking energy.