An energy management control strategy is proposed for an islanded AC microgrid with the hybrid energy storage system, including the battery and the supercapacitor (SC). According to the state of charge of the battery, the photovoltaic system can work in either maximum power point tracking mode or load power tracking mode to prevent the battery from over charging. Similarly, the load shedding control is adopted to prevent the battery from over discharging. A virtual impedance control strategy is proposed to achieve effective power sharing in hybrid energy storage systems, where the battery provides steady state power and the SC only supports transient power fluctuations. The terminal voltage of the SC can be restored to the initial value automatically by introducing a high-pass filter in the voltage control loop. The AC bus voltage remains constant using the voltage secondary controller to compensate the voltage drop caused by the virtual impedance control strategy. The simulation results under typical working conditions verify the correctness and effectiveness of the proposed control strategy.