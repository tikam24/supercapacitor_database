In this paper, an extended run time DC UPS system structure with fuel cell and supercapacitor is investigated. A wide input range bi-directional dc-dc converter is described along with the phase-shift modulation scheme and phase-shift with duty cycle control, in different modes. The delivered power and peak current are analyzed and calculated. The key parameters of the bi-directional dc-dc converter, the relationships between the input voltage, phase-shift angle, ratio of the transformer and leakage inductance are analyzed and optimized. Build the system mathematic model and a novel input voltage combined with load current feedback using PI controller with anti-windup scheme to realize closed-loop control of the whole system, and verify the feasibility of the control scheme proposed by simulation. A 1kW prototype controlled by TMS320F2808 DSP is implemented and tested. Experimental results show the validity of design. Â©2009 IEEE.