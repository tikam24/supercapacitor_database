In this paper, a hierarchical control of energy management strategy is proposed based on tram hybrid hybrid system. In this strategy, the top strategy achieves the energy distribution between the various systems under different operating conditions by dividing the running status of trams. And the bottom strategy achieves the energy distribution between multiple sets of each energy system. In the bottom strategy, in order to solve the problem of voltage imbalance in the process of charge and discharge of supercapacitor system, an algorithm based on adaptive charge and discharge coefficient is proposed, which makes the voltage of all supercapacitor systems balance quickly during their charge or discharge process. At the same time, to improve the overall efficiency of the two sets of fuel cell systems, this paper also proposed the efficiency interval control algorithm, which makes the efficiency of whole fuel cell system reach a higher level.