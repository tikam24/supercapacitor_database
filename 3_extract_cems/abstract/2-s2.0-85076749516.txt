In this paper, to avoid peak demand rising and energy management for ship to shore (STS) cranes, three main steps based on the optimization method are considered. The first step for peak shaving in this paper is demand side management (DSM). Since the new generation of STS cranes installed at the port of Long Beach (POLB) are equipped with regenerative capabilities to absorb up to 90% of the energy by the coordination of cranes' duty cycles. For the second part, the utilization of ultracapacitor (UC) is made for local peak shaving for each STS Crane. Finally, a Hybrid Energy Storage System (HESS) for comprehensive peak shaving is used. Since each STS Crane has a separate DC bus, the UC cannot do the peak shaving for the group cranes. For this purpose, for each DC bus in an STS Crane and UC bank can be considered to provide the local peak shaving and HESS is able to do the general peak shaving for two STS groups cranes where each group consists of 4 or 5 STS cranes. This is because for all groups there is a common AC bus and HESS can be installed between the groups. Also, integration on HESS is able to decrease significantly the required power in point of POLB as well. The control strategy proposed in this paper is capable to control the sudden power increase in CTs due to the use of a greater number of STS cranes and enhance the productivity of the system.