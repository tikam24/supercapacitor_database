Distributed generation units in the microgrid are intermittent and random, which can't meet the demand of grid power stability. In this paper, hierarchical control strategy is used to research hybrid storage system: The superstratum is the microgrid central management and control system, and it contains both distributed generation units and load requirements; the lower layer is the local control system of the hybrid energy storage system, and the high/low frequency fluctuation power of the system is distinguished by moving average filtering. The Ampere-hour integral method combined with the open circuit voltage method to calculate state of charge (SOC) in lithium battery and supercapacitor. The simulation results show that the proposed hybrid energy storage system can meet the requirements of distributed generation in microgrid, and the energy storage units in the hybrid energy storage system can avoid excessive charging and discharging.