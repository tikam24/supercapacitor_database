Summary This paper proposes three near-optimal (to a desired degree) deterministic charge and discharge policies for the maximization of profit in a grid-connected storage system. The changing price of electricity is assumed to be known in advance. Three near-optimal algorithms are developed for the following three versions of this optimization problem: (1) The system has supercapacitor type storage, controlled in continuous time. (2) The system has supercapacitor or battery type storage, and it is controlled in discrete time (i.e., it must give constant power during each sampling period). A battery type storage model takes into account the diffusion of charges. (3) The system has battery type storage, controlled in continuous time. We give algorithms for the approximate solution of these problems using dynamic programming, and we compare the resulting optimal charge/discharge policies. We have proved that in case 1 a bang off bang type policy is optimal. This new result allows the use of more efficient optimal control algorithms in case 1. We discuss the advantages of using a battery model and give simulation and experimental results.