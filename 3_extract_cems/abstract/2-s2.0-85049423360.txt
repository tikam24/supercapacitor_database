This paper presents a novel power flow control strategy, combined with an economic analysis, for an energy management system (EMS) involving a hybrid energy storage. The EMS operates a remote microgrid and directs the power flow to either batteries or supercapacitors to increase the life of the batteries. This paper demonstrates how the use of supercapacitors increases the lifetime of the batteries and ultimately how it affects the economics of the system. The proposed EMS controller also compensates for the 120-Hz ripple on the dc bus. Modeling, simulations, and experimental verification are presented together with the procedure to perform the assessment of the battery lifetime, according to the tuning parameters of the controller.