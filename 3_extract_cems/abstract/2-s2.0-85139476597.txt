Waste biomass-derived carbon materials are attracting widespread attention in energy devices due to their renewable environmental protection and heteroatom-rich functionalization. In this work, we propose the preparation of N/O self-doping 3D cage-like porous structures and 2D porous carbon nanosheets by one-step carbonization of activated peanut oil residues with non-toxic K2CO3 at different temperatures (PKs). The fabricated porous carbon materials own a higher specific surface area (1657-2920 m2 g-1), higher nitrogen (1.38-4.41 at. %) and oxygen doping (2.48-4.98 at. %), and higher degree of graphitization. The as-resulted PK-800 possesses a 3D cage-like porous structure, and the electrode at high loads of 12.5 mg cm-2 can achieve an excellent area specific capacitance of 4400 mF cm-2 at 0.5 A g-1. The symmetric components of PK-800 have an ultra-high energy density of 60.31 W h kg-1 at 372 W kg-1 in 1 M TEMATFB/PC. Besides, when applied to the Li-ion battery anode, the prepared highly graphitized 2D porous carbon nanosheets of PK-900 have a high reversible capacity of 580 mA h g-1 at 0.1 A g-1 after 200 cycles. This study proposes a feasible method to activate waste biomass by carbonization in one step and exploit it layer by layer into the desired carbon material for energy storage.