A hybrid electric vehicle (HEV) composed of an internal combustion engine (ICE) and a permanent magnet synchronous machine (PMSM) is considered in this paper. Batteries supply power to the PMSM. Referring to previous studies, other than delivering driving forces, PMSM can be exploited as an 'active flywheel' and compensate the torque ripples generated by the ICE. These ripples are thus delivered to the DC bus, and result in an oscillating current in the battery, which will severely reduce the battery lifetime. Taking this into consideration, this paper aims to design an 'active damping' so as to attenuate the oscillations in the DC bus voltage. This is achieved by connecting a supercapacitor in parallel with the battery, and constructing an effective controller. The influence of the current ripples is modeled as an external current perturbation. Moreover, transients and nonstationary fluctuations of the vehicles are considered as another perturbation. In order to realize perturbation rejection, a nonlinear control strategy with an inner fast loop and an outer slow loop is proposed. The controller is based on system passivity and energy distribution. The effectiveness of the control algorithm is verified through simulation.