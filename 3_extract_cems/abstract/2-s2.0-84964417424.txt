This paper considers a real-time embedded system which uses an energy harvester and a non-ideal supercapacitor to supply the system energy. As supercapacitors suffer from energy leakage, the stored energy is better to be consumed as soon as possible. PFPASAP is a previously proposed preemptive fixed-priority scheduling algorithm that executes jobs as soon as possible when the available energy is enough to execute one time unit of the highest priority job. This algorithm assumes an ideal non-leaking energy storage unit. In this paper, however, we present another version of the algorithm, named NI-PFPASAP, which considers a non-ideal supercapacitor as the energy storage. For this purpose, we calculate the energy leakage of each task that can be broken into two parts: (i) leaked energy at the charging interval, and (ii) leaked energy at the discharging interval. Also, the optimality of the proposed method is proven in the paper. Finally, the importance of taking the non-ideality of the supercapacitor into account during task scheduling is evaluated by comparing the proposed method with PFPASAP using extensive simulations.