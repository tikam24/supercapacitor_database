The energy storage system is an indispensable component of the Mircogrid. It can be used to satisfy power quality requirement, to provide urgent power supply and suppress power fluctuation of renewable power generation. Battery/supercapacitor hybrid energy storage system (HESS) is an effective way to suppress power fluctuation of photovoltaic power generation system during radiation change. This paper focuses on the power sharing problem between energy-density and power-density components of the HESS. First, a hierarchical power allocation strategy is proposed to optimize the response frequency as well as state-of-charge (SOC) of supercapacitors. Second, the design of the low pass filter with time constant adjustment module, the over-charging /discharging protection module and maximal power control module are introduced. Finally, The simulation results proved the effectiveness of the proposed approaches.