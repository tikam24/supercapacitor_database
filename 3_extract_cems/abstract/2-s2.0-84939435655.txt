Micro-grid is one of important and efficient ways to take advantage of large-scale distributed Generation. In allusion to switching between the grid-connected and islanding operation modes, we proposed a control strategy of micro-grid with different types of distributed generation and hybrid energy storage system. On the basis of analyzing the characteristics of batteries and Super capacitor, the high power density of super capacitor and large energy density of battery is composed to form a hybrid energy storage system, which is used as master in micro-grids with different types of distributed generation, so as to realize the seamless switching of micro-grid operating modes. By online monitoring the frequencies, voltage amplitude, and voltage phase angle on both distributed network and micro-grid sides, a micro-grid model with hybrid energy storage is established. The seamless switching of micro-grid operation modes is achieved automatically by using multi-level control strategies. A simulation is implemented using the PSCAD/EMTDC software. The results show that the switching time, frequency, voltage, and phase angle difference of the hybrid energy storage system are less than those of battery energy storage, and the proposed optimal switching control strategy and the hybrid energy storage system are effective and feasible.