Waste resource utilization of petroleum coke is crucial for achieving global carbon emission reduction. Herein, a series of N-doped microporous carbons were fabricated from petroleum coke using a one-pot synthesis method. The as-prepared samples had a large specific surface area (up to 2512 m2/g), a moderate-high N content (up to 4.82 at.%), and high population (55%) of ultra-micropores (<0.7 nm). Regulating the N content and ultra-microporosity led to efficient CO2 adsorption and separation. At ambient pressure, the optimal N-doped petroleum coke-based microporous carbon exhibited the highest CO2 uptake of 4.25 mmol/g at 25째C and 6.57 mmol/g at 0째C. These values are comparable or even better than those of numerous previously reported adsorbents prepared by multistep synthesis, primarily due to the existence of ultra-micropores. The sample exhibited excellent CO2/N2 selectivity at 25째C owing to the abundant basic pyridinic and pyrrolic N species; and showed superior CO2 adsorption-desorption cycling performance, which was maintained at 97% after 10 cycles at 25째C. Moreover, petroleum coke-based microporous carbon, with a considerably high specific surface area and hierarchical pore structure, exhibited excellent electrochemical performance over the N-doped sample, maintaining a favorable specific capacitance of 233.25 F/g at 0.5 A/g in 6 mol/L KOH aqueous electrolyte. This study provides insight into the influence of N-doping on the porous properties of petroleum coke-based carbon. Furthermore, the as-prepared carbons were found to be promising adsorbents for CO2 adsorption, CO2/N2 separation and electrochemical application.