Abstract A new approach to determine the capacity of a supercapacitor-battery hybrid energy storage system (HESS) in a microgrid is presented. The microgrid contains significant wind power generation and the HESS is to smooth out the fluctuations in the delivered power to load. Using empirical mode decomposition (EMD) technique, historical wind power data is firstly analyzed to yield the intrinsic mode functions (IMF) of the wind power. From the instantaneous frequency-time profiles of the IMF, the gap frequency is identified and utilized in the design of filters which decompose the wind power into the high- and low-frequency components. Power smoothing is then achieved by regulating the output powers of the supercapacitors and batteries to negate the high- and low-frequency fluctuating power components, respectively. The degree of smoothness of the resulting power delivered to load is assessed in terms of a newly developed level of smoothness (LOS) criteria. A neural network model is then utilized to determine the storage capacity of the HESS through the minimization of an objective function which contains the costs of the HESS and that associated with the achieved LOS. Example of the design of a supercapacitor-lead acid battery HESS for an existing wind farm demonstrates the efficacy of the proposed approach.