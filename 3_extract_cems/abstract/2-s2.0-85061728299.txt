Capacity configuration of distributed generation is an important aspect in the microgrid planning and design stage. The pros and cons of capacity configuration of distributed generation will directly affect the economy of microgrid, reliability of power supply, and environmental effect. Since the power-type energy storage system(PTESS) such as supercapacitor and flywheel energy storage cannot be optimally configured over a long-time scale, the integrated configuration including wind power, photovoltaic system, diesel generator, and hybrid energy storage system(HESS) becomes difficult. To solve this problem, this paper proposes a two-stage configuration model for stand-alone microgrid considering dual time scales: the first stage is the hour time scale optimization configuration, which can solve the configuration results of PV-Wind-Diesel-Battery; the second stage optimal configuration is the time scale of second level, which can solve the configuration results of 'power-type energy storage' based on the result of the first stage model.