In this paper, an adaptive extremum seeking control strategy with sliding mode is develop to charge the ultracapacitor light rail vehicles. Compared with existing model-based charging algorithms, the proposed extremum seeking (ES) charging control strategy is model-free, which implies that it can handle the ageing effect of ultracapacitors well. Moreover, a sliding mode mechanism is embedded into the charging controller to suppress the disturbances introduced by sensors. Simulation and experiment results are presented to show the effectiveness of the proposed design.