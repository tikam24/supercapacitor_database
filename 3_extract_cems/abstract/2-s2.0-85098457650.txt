Aiming at tram energy consumption of contactless power supply, a method is developed to reduce operating energy consumption and improve regenerative braking energy recovery when energy storage capacity is limited. The method can redistribute the three working conditions of traction, coasting and braking and the output of a train in the traction and braking conditions, provided that the running distance between the train stations is constant, the running time between stations is within the feasible range, and the supercapacitor is capable of absorbing braking power. Then it calculates a train target running curve that achieves energy saving and improves braking energy recovery. Finally, the method optimizes the actual running line of a tram. The simulation results show that the proposed method reduces the operating energy consumption by 4% on average during the redundant time. Meanwhile, the supercapacitor increases the energy feedback in brake feedback by 4% and can operate safely during the braking process of the tram.