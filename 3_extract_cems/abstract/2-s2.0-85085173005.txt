The braking energy absorption of urban rail transit has always been an important issue. The use of supercapacitors for energy absorption is an efficient way. In order to make the supercapacitors of each substation better recover the braking energy, the traction substation is equivalent to the voltage source and the virtual impedance, and then the virtual impedance is configured to achieve the average distribution of braking current among the supercapacitor braking energy absorption devices in the adjacent traction substation, or as far as possible. For such voltages and resistances are uncertain, the multivariate online solution is difficult to achieve by traditional methods. In this paper, through the equivalent and simplification of the circuit topology, and the introduction of the genetic algorithm, the simultaneous solution of voltage and resistance is realized. Four different situations are analyzed.