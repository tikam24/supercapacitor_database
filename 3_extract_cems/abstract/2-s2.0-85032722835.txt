This paper presents a methodology for the joint capacity optimization of renewable energy (RE) sources, i.e., wind and solar, and the state-of-the-art hybrid energy storage system (HESS) comprised of battery energy storage (BES) and supercapacitor (SC) storage technology, employed in a grid-connected microgrid (MG). The problem involves multiple fields, i.e., RE, battery technology, SC technology, and control theory, and requires an efficient and precise co-ordination between sub-fields to harness the full benefits, making the problem labyrinthine. The optimization problem is formulated, and it involves a variety of realistic constraints from both hybrid generation and storage, and an objective function is proposed to: 1) minimize the cost; 2) improve the reliability; and 3) curtail greenhouse gases (GHG) emissions. The complex optimization problem is solved innovatively in piecewise fashion to decrease the complexity and computational time. First, sizes of solar photovoltaic (PV) and wind turbine (WT) are determined using an innovative search algorithm, and in the second step, the size of HESS is calculated, finally the optimal solution is determined. A comparison based upon cost, reliability, and GHG emissions is presented which plainly shows the effectiveness of the proposed methodology. The technique is also applied to determine the size of an MG employing PV, WT, and BES operating in grid-connected mode. And a brief cost analysis, reliability assessment, and emission reduction are given for three scenarios: 1) MG with HESS; 2) MG with BES; and 3) MG with conventional generation. It is shown that an MG with HESS is not only economical but also more reliable and has lower GHG emissions.