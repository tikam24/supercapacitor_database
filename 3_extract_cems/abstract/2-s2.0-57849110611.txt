It's a challenging task to take advantage of large baking energy of metro vehicles because of high power and high current. To save energy and stabilize voltage for the metro supply network, the new high power storage system is analyzed and the design process of charge and discharge unit which adopts non-isolated bi-directional convertor is presented. Then the system stability and performance are verified via theory and simulation. To design a reliable control algorithm rapidly and efficiently, a new development approach via Simulink/Stateflow is presented. Meanwhile, the control rapid implementation flow based on DSP is generalized. Finally, the embedded C code suitable for LF2407A DSP platform is generated automatically and is verified by experiment. This approach is also suitable for other power electronics control system for the metro, which can facilitate the project development and enhance system reliability. Â© 2008 IEEE.