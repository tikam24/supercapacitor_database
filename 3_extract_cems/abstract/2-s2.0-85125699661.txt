This paper presents an analysis of the model and control of a hybrid energy storage system (ESS) based on supercapacitor and battery for supporting the power grid. The power conversion system consists of a bidirectional dc-dc converter as an additional stage for regulating the dc-link voltage of the dc-ac converter, which is connected to a three-wire three-phase system. The grid power control is implemented based on the instantaneous $pq$ theory, in order to achieve low-frequency demand from the power control of the batteries. Thus, the power peaks are automatically provided by the supercapacitors. From this solution, a smaller battery size, a longer battery life and a higher overall system efficiency can be achieved compared to a conventional battery ESS. To verify the effectiveness of the proposed system, simulation results are presented, and a comparison between the conventional battery ESS and the proposed solution is also presented.