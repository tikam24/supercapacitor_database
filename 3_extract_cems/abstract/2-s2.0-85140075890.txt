Renewable energy has gained enormous popularity in recent years. Both independent and grid-connected renewable energy generating capacity has increased. The potential to create green energy that is both ecologically benign and financially operative is the primary argument. To reduce the cost of maintaining a hybrid microgrid, this study provides a novel control algorithm as well as a suitable energy management system. The energy storage technologies are used in the hybrid microgrid system which consist of photovoltaic cell, fuel cell and supercapacitor. The optimal power flow in the hybrid microgrid component is developed using energy management system which consents control system to batteries, load and economic analysis with the input of electric grid. In this paper supercapacitor is which is directly connected to DC and provide fast response to load changing. DC voltage, current and hybrid microgrid is managed using the local control system. The power change in photovoltaic system is solved using energy storage system. The purpose of control method in hybrid microgrid is used to enhance the hybrid microgrid flexibility and generation of renewable resources and stored it in grid. The effectiveness and the flexibility of the proposed controller in energy management of hybrid microgrid system is simulated. The proposed energy management system provides high performance related to the existing energy management system.