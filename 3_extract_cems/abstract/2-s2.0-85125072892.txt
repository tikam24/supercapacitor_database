To addresses the voltage issue in the distribution network caused by high PV penetration and the high cost of energy storage systems, a behind-the-meter battery scheduling and control algorithm has been proposed in this paper. The proposed solution includes a control framework that can schedule the day-ahead battery operation and prevent overvoltage in distribution systems. Two different techniques that aim to prolong battery life have been quantified, one is a hardware-based technique that uses a parallel connected supercapacitor to absorb large charging and discharging current; the other is a software-based technique that considers the battery degradation cost as part of the scheduling optimization. The proposed algorithm is evaluated via both the numerical simulation in the IEEE 13-node test feeder and hardware experiments. Based on the experiment results, a long-term system economic analysis has been made.