The strong fluctuation and intermittent of PV power generation have a great impact on the power quality and reliability of the power grid. A hybrid energy storage system (HESS) consisting of batteries and supercapacitors is always used to smooth PV power fluctuation, thereby reducing the impact on the grid. In this paper, based on the different characteristics of batteries and supercapacitors, a two-stage PV power fluctuation smoothing method is proposed. This method aims to meet the PV active power fluctuation standard in two different timescales. In the first stage, according to the short-term prediction of the PV power generation, the wavelet packet decomposition strategy is used to distribute the high-frequency component and obtain the first part power commands of the battery and the supercapacitor. In the second stage, based on the two-timescale PV active power fluctuation standard, the commands of the battery and the supercapacitor can be adjusted in real time. Further, two test days, i.e. sunny day and cloudy day, are used to verify the efficiency of the proposed two-stage PV power fluctuation smoothing method. Numerical results show that the proposed method can smooth the PV power generation fluctuations effectively by taking full advantage of the performance benefits of the HESS.