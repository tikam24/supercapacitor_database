In the smart grid, an increase of Electric vehicles and renewable energies leads to care about energy storage design and control. There are many types of energy storage, each type has distinguishing properties. This paper discusses the theory of hybrid energy storage to achieve the best exploitation of storage units to match the load requirements. Fuel cell, battery, and supercapacitor are used as storage units according to these significant features rather than other types such as "high storage energy, high efficiency and fast discharge". The mathematical model of the three storage types and proposed hybrid energy storage models are presented. To achieve the best combination of hybrid energy storage, this paper introduces two-steps storage sizing technique. The first step computes the total size of the storage units. The second step computes the size of each storage unit of the hybrid storage system by using analytical hierarchical processing (AHP) and the swarm technique. AHP is used to calculate weight factor for each of the four attributes "weigh, cost, response time, and efficiency" of each storage unit based on the judgment matrix. Then, swarm technique computes the required size of each storage unit base on AHP results and the load specifications. Finally, two cases are introduced to verify the proposed algorithms, one of them is a moving load "electric vehicles" while the second one is a non-moving load "microgrid with renewable energy sources".