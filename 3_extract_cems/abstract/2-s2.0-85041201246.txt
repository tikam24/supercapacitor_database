The utilization of a supercapacitor energy storage system (ESS) to store regenerative braking energy in urban rail transit can achieve an energy-saving effect. This paper proposes a brake voltage following energy management strategy of ESS to adjust the charging and discharging threshold voltage based on the analysis of train operation states. The energy storage device state of charge is considered to realize the maximum usage of the ESS. First of all, the mathematical model of the dc traction power system, which encompasses the train, ESS, and traction substation, is established. Then, the energy allocation influence factors are analyzed, in particular for the double train structure. Second, under the different conditions, with the real-time monitoring of the traction network voltage and the train status, an energy management state machine is determined. Meanwhile, a set of effective state switching schemes is given to achieve the transformation of the energy management states. In the end, both the simulations using actual line data and main track field experiments prove the rationality and validity of the proposed management strategy.