Frequency stability is an important issue for the operation of islanded microgrids. Since the upstream grid does not support the islanded microgrids, the power control and frequency regulation encounter serious problems. By increasing the penetration of the renewable energy sources in microgrids, optimizing the parameters of the load frequency controller plays a great role in frequency stability, which is currently being investigated by researchers. The status of loads and generation sources are received by the control center of a microgrid via a communication system and the control center can regulate the output power of renewable energy sources and/or power storage devices. An inherent delay in the communication system or other parts like sensors sampling rates may lead microgrids to have unstable operation states. Reducing the delay in the communication system, as one of the main delay origins, can play an important role in improving fluctuation mitigation, which on the other hand increases the cost of communication system operation. In addition, application of ultra-capacitor banks, as a virtual inertial tool, can be considered as an effective solution to damp frequency oscillations. However, when the ultra-capacitor size is increased, the virtual inertia also increases, which in turn increases the costs. Therefore, it is essential to use a suitable optimization algorithm to determine the optimum parameters. In this paper, the communication system delay and ultra-capacitor size along with the parameters of the secondary controller are obtained by using a Non-dominated Sorting Genetic Algorithm II (NSGA-II) algorithm as well as by considering the costs. To cover frequency oscillations and the cost of microgrid operation, two fitness functions are defined. The frequency oscillations of the case study are investigated considering the stochastic behavior of the load and the output of the renewable energy sources.