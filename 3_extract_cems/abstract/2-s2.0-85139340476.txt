Aiming at the problem that the slow operation of traditional synchronous generator may affect the stability of microgrid system, the application of virtual inertia control method in doubly fed induction motor wind turbine is studied. Firstly, two control methods and their mathematical models introducing virtual inertia are introduced in detail. Then, by constructing a small signal model, the influence of the proposed control method on the stability of microgrid system in island mode is studied. The advantages and disadvantages of using doubly fed wind turbine rotating mass or super capacitor as virtual inertia source and the influence of wind speed change on system stability are compared. Finally, the simulation model is established based on Matlab/Simulink. The simulation results show that the introduction of virtual inertia can significantly increase the system stability, but the effect of virtual inertia control based on rotating mass is greatly affected by fan speed, and the effect of virtual inertia control based on supercapacitor is the best.