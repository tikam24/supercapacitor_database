As a new energy storage element, supercapacitor not only could be used to meet the power balance in microgrid, but also could solve many power quality issues. However, its low energy density determines other energy source should be considered to compensate its performance. A supercapacitor based united power quality conditioner (UPQC) in microgird is proposed in this paper, which consists of supercapacitor, PV, bi-directional DC/DC converter, shunt inverter and boost-buck DC/DC converter. The structure and power flow model of this UPQC was analyzed. The control of the shunt inverters and the charging strategy of the supercapaciter were introduced. The simulation results verified the effectiveness of the proposed circuit and control strategy.