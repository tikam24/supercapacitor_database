Wind shear and tower shadow effects generate severe fluctuations on the generated power of wind turbines (WTs). Consequently, in WT-integrated microgrids (MGs) with battery energy storage, these power fluctuations can generate battery microcycles that can significantly reduce the battery's lifetime. In this paper, the impact of battery microcycles on battery lifetime is investigated and a method that uses a hybrid supercapacitor-battery energy storage system to mitigate these microcycles in a wind-diesel microgrid is proposed. The design, power allocation strategy, and control of the power converters are discussed; the supercapacitor size is determined based on the decomposition of frequency components of the WT output power, using discrete Fourier transform to appropriately mitigate the battery microcycles. The components of the MG, wind shear, and tower shadow effects are modeled in detail using MATLAB/Simulink, TurbSim, AeroDyn, and FAST software tools. Finally, the performance of the proposed method is investigated and verified in simulation, considering two case studies where either battery-only or battery-supercapacitor are used. In addition, a cost-benefit analysis of the proposed system is given. The results show that the proposed method can appropriately mitigate the battery microcycles, which can result in increasing battery lifetime and reducing the total system costs.