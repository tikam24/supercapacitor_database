This paper presents a pinning-based switching control approach for the charging and cell balancing of supercapacitors. The developed supercapacitor energy storage system is modeled as a cyber-physical system (CPS), which consists of a physical layer, a cyber layer, and a control layer. In the physical layer, the switched resistor circuit is employed to charge and balance supercapacitor cells, and the physical system is mathematically characterized using the switched systems' theory. The cyber layer is modeled with the graph theory to characterize the accessibility of the reference voltage and the availability of neighbors' information to cells. In the control layer, a pinning-based switching control law is proposed to balance cell voltages during the charging process. The stability of the CPS is rigorously proved and the closed-loop model of the CPS is derived using the block diagram. A laboratory testbed has been built to verify the effectiveness of the proposed method. Extensive experiment results show that the proposed pinning control method can reduce the voltage deviation and improve the energy efficiency when compared with the classical decentralized control method. Some practical issues about the implementation of the proposed method are also discussed.