In order to obtain improvement in energy efficiency of urban rail transportation system by usage of regenerative breaking energy this article deals with modeling of the rail vehicle and energy storage, as well as, with proposing form of breaking energy flow control algorithm. The control algorithm is based on maximization of used regenerative breaking energy as well as maximization of a storage element charge-discharge life cycle. The critical thresholds of the algorithm should be obtained by optimization. The accurate simplified rail vehicle model with storage element model suitable for control algorithm optimization is developed in this article. In addition, control algorithm and optimization cost function are proposed in order to maximize used regenerative breaking energy and life cycle of the storage element. The roll of control algorithm during implementation phase on real vehicle will be generation of the reference signal for low level control algorithms of the supercapacitor converter.