This paper proposes an enhanced energy management system (EEMS) for a residential AC microgrid. The renewable energy-based AC microgrid with hybrid energy storage is broken down into three distinct parts: a photovoltaic (PV) array as a green energy source, a battery (BT) and a supercapacitor (SC) as a hybrid energy storage system (HESS), and apartments and electric vehicles, given that the system is for residential areas. The developed EEMS ensures the optimal use of the PV arrays' production, aiming to decrease electricity bills while reducing fast power changes in the battery, which increases the reliability of the system, since the battery undergoes fewer charging/discharging cycles. The proposed EEMS is a hybrid control strategy, which is composed of two stages: a state machine (SM) control to ensure the optimal operation of the battery, and an operating mode (OM) for the best operation of the SC. The obtained results show that the EEMS successfully involves SC during fast load and PV generation changes by decreasing the number of BT charging/discharging cycles, which significantly increases the system's life span. Moreover, power loss is decreased during passing clouds phases by decreasing the power error between the extracted power by the sources and the required equivalent; the improvement in efficiency reaches 9.5%.