In view of the possible shortcomings caused by a single battery energy storage system or a super capacitor energy storage system, it is proposed to combine the two to form a hybrid energy storage system, so that the advantages of the two complement each other, extend the service life of the battery, and improve the large-capacity power storage. And based on the control strategy of solar storage power generation, the concept of hybrid energy storage virtual moment of inertia is proposed, and its frequency response is analyzed in combination with the control strategy of hybrid energy storage. Through the charge detection of the battery and the super capacitor, the two are in the normal working range to avoid overshoot and overdischarge. Finally, a simulation system is built to verify that the virtual inertia of the hybrid energy storage can improve the frequency response of the system and make the system more stable.