Renewable energy-based direct current microgrids are becoming popular due to their higher energy efficiency than AC microgrids. Energy storage system (ESS) helps to stabilise the system against the instability caused by stochastic nature of the renewable sources as well as demand variation within a microgrid. This work proposes effective energy management and control techniques for a photovoltaic-based DC microgrid. In order to regulate power exchange with the main grid, model predictive controller (MPC) is proposed to control bidirectional voltage source converter. The performance of MPC is compared with classical PI controller. Frequency approach control of hybrid ESS comprising of battery and supercapacitor is used to suppress both low-and high-frequency power variation in the microgrid by exchanging power with DC bus. To confirm the efficacy of proposed control strategy, real-time simulations of the system are carried out considering both grid-connected and islanded modes of the microgrid operation. The results show the effectiveness of the proposed control strategy for energy management in the microgrid. Further, real-time controller hardware-in-the-loop experiment validates the simulation results.