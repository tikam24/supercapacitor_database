In this paper, the concept of frequency-coordinating virtual impedance is proposed for the autonomous control of a dc microgrid. This concept introduces another degree of freedom in the conventional droop control scheme, to enable both time-scale and power-scale coordination in a distributed microgrid system. As an example, the proposed technique is applied to the coordinating regulation of a hybrid energy storage system composed of batteries and supercapacitors. With an effective frequency-domain shaping of the virtual output impedances, the battery and supercapacitor converters are designed to absorb low-frequency and high-frequency power fluctuations, respectively. In this way, their complementary advantages in energy and power density can be effectively exploited. Furthermore, the proposed concept can be integrated into a mode-adaptive power management framework with autonomous mode transitions. The entire solution features highly versatile functions based on fully decentralized control. Therefore, both flexibility and reliability can be enhanced. The effectiveness of the presented solution is verified by experimental results.