Because of the instability and uncontrollability of the nitrogen-containing precursor upon high-temperature carbonization, it is very hard to obtain nanocarbon with high nitrogen content over 10 atom% and controllable electrochemically-active nitrogen species. Herein, we report a role-divided templating/doping strategy for the fabrication of porous nanocarbon supercapacitor materials with all-electroactive nitrogen species and ultrahigh energy density based on MgO and g-C3N4, in which MgO first acts as a polymerization catalyst to form carbon source and then as template for porous structure, while the g-C3N4 acts as a single nitrogen source. Systematic investigations reveal that the carbonization temperature and the single g-C3N4 nitrogen source are vital to obtaining all-electroactive nitrogen species. The obtained nanocarbon (WNLC973-C1N5) owns a worm-nest-like morphology, high surface area and all-electrochemically-active nitrogen functionalities (21.3 atom%). The symmetric supercapacitor based on WNLC973-C1N5 achieves an energy density of 53.2 Wh/kg at a power density of 1000 W/kg, about four times bigger than that of normal carbon-based material. This work highlights the importance of the special nitrogen source to form the all-electrochemically-active nitrogen functionalities for high-performance energy materials and presents facile strategy to fabricate carbon-based materials for extensive applications, such as catalyst, adsorbent, catalyst support, energy material and so on.