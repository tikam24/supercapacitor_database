The gradually increasing number of distributed generators in microgrids cause negative affections to their dynamic stability. Moreover, dynamic performance of small synchronous generators such as diesel is usually poor due to slow response and low inertia. To overcome these drawbacks, virtual synchronous generator is considered as a promising suggestion to improve dynamic characteristics of synchronous generators in such a way of increasing microgrid inertia, especially in islanded operation. This paper analyzes the dynamic stability of microgrid including diesel generator, photovoltaic, loads and an energy storage system based on a voltage-source inverter equipped with virtual synchronous generator control strategy. Supercapacitor with fast response capability is utilized to inject demand's power from voltage source inverter. Nonlinear mathematical models of microgrid used for this study are built in Simulink/Matlab environment. Finally, simulation results in time-domain under various operating conditions are presented to verify the effectiveness of virtual synchronous generator suggestion.