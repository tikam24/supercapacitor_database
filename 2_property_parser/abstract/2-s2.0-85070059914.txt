This paper proposes a hierarchical optimization energy management strategy to suppress the battery aging in plug-in hybrid electric vehicles. In the first-level, a variable-threshold dynamic programming algorithm to distribute the power between the energy storage system and the engine is proposed. By adding supercapacitor to form the hybrid energy storage system, and using adaptive low-pass filtering algorithm, the power between the battery and the supercapacitor is distributed. To control the supercapacitor and battery to work within the capacity range, a power limits management module for redistributing the power between the engine, the supercapacitor and the battery is considered. The adaptive low-pass filtering algorithm and power limits management module constitute adaptive power allocation method in the second-level. After that, the rain-flow counting algorithm is applied in this paper to calculate battery aging cost. By using the rain-flow counting algorithm, the battery performances are analyzed, and the results show that the adaptive power allocation method can improve the battery service life by about 54.9% compared with the global dynamic programming algorithm. Considering the initial cost of the supercapacitor, the costs of battery aging, fuel consumption, electricity consumption, and management cost of retired batteries, compared with the global dynamic programming algorithm, the life cycle economy of the vehicle is improved by 12.4% under the proposed method.