The emerging structure of wind storage microgrid is applied to promote local consumption of wind power and improve power supply reliability by the duality of source and load of energy storage. In order to improve the utilization of energy storage in microgrid, a hybrid energy storage system (HESS) structure of supercapacitor in parallel with DC side of each wind turbine and lithium battery connected to point of common coupling of wind farm is proposed. The control strategies of HESS in both grid-connected and off-grid modes are given in this paper. According to the mathematical model of supercapacitor and lithium iron phosphate battery, a 35kV wind storage microgrid system is built in MATLAB/Simulink. Actual measured wind speed is imported into the model, and dynamic response of HESS to wind power smoothing and microgrid frequency control under two operating modes are simulated and analyzed. Results show that the system can realize reliable connection of wind power to grid and stable operation during off-grid, and the effectiveness of the proposed system structure and control strategy is verified.