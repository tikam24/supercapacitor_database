Under the traditional droop control, hybrid energy storage system cannot take advantage of the respective merits of battery and supercapacitor for frequency coordination, which shortens system life. Because of the single-phase inverter load, the second harmonic current is generated in the front-stage converter when the output power pulsates at twice the output voltage frequency. This paper proposes a strategy for frequency coordination and second harmonic current suppression based on composite virtual impedance. Under this strategy, the system equivalent output impedance exhibits resistance and inductance in low-frequency part, dominated by the battery side. The battery reacts slowly to absorb the low-frequency power fluctuations and provide the energy required by load at steady state. It is capacitive in the high-frequency range, with the supercapacitor side dominating. The supercapacitor quickly absorbs the high-frequency part of power fluctuation to suppress the impact of load mutation on DC bus and improve system dynamics. Meanwhile, the strategy realises that the inductor branch impedance is significantly larger than the capacitor branch impedance at double frequency, suppressing the second harmonic current and increasing the system efficiency. Experimentation confirms the effectiveness of the control strategy.