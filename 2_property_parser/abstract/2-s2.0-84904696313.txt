In this paper, the real-time operation and the harmonic analysis of isolated and nonisolated dc microgrid are investigated. The microgrid features hybrid energy sources with various loading schemes. This hybrid dc microgrid was supplied by an internal generator and the ac utility grid. A supercapacitor bank functions by acting as a power buffer to satisfy the high power requirements of the dc microgrid. In order to properly manage the energy and prevent the ac grid power pulsation, a current-voltage control technique based on master-slave control concept is proposed. In this technique, the supercapacitor bank operates as the master and controls the dc bus voltage. The other converters are working in current control mode to share the required power. The controllers of the converters are equipped with hysteresis voltage control, which monitors the entire supercapacitor bank. Additionally, an analog hysteresis voltage protection circuit board was designed and implemented to protect the supercapacitor cells from overvoltages that can occur due to uneven charge distribution during the fast charging processes. The protection circuit, which was developed and built here, was experimentally tested, and its error was analyzed. Various operating modes based on different power sharing patterns were defined. The experimental test was carried out for both galvanically isolated and nonisolated dc grid systems. The results show that the proposed energy management algorithm properly shares power and control the voltage. In addition, depending on the power sharing pattern, the isolation of the dc microgrid significantly affects the harmonic content of the current. Â© 2014 IEEE.