High penetration levels of variable renewable energy sources (RESs) such as wind and photovoltaic (PV) into microgrids (MGs) considerably impact on the operation of the power grid. Energy storage represents a large class of technologies with the potential to address this power intermittency issue. Among them, supercapacitor energy storage (SCES) is capable of significantly enhancing the dynamic security of the MG. This paper proposes the use of an improved SCES controller for smoothing the power flow of MGs with strong presence of intermittent renewable generation. To this aim, a detailed model of the SCES is derived and a control scheme is designed, comprising a full decoupled current control strategy and an enhanced active power flow controller. The dynamic performance of the proposed systems is fully validated by computer simulation.