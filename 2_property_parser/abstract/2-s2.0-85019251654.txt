Energy storage would play a critical role in the microgrids. In this paper, two-stage variable rate-limit control for battery energy storage is proposed. The objective of this control scheme is to optimize the amount, rate, and time-duration of the energy stored/discharged from the battery. Thus, the battery would charge/discharge at its optimized maximum rate in a hybrid energy storage system. Supercapacitor is used to form the hybrid energy storage system, to complement or supply the energy deficiency during the transient period. With the proposed control scheme, the stress levels on the battery is regulated by optimizing the charge/discharge rates of the battery. The advantages of the proposed control scheme also includes maintaining the state of charge of the battery within the limits for longer duration. This control scheme is validated using real-time control hardware in loop using OPAL-RT and dSPACE.