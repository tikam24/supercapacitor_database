The energy management system (EMS) of microgrid deals with lots of complex issues, both from generation and demand side. The intermittent nature of renewable energy sources and constantly fluctuating load demands require robust energy management. This paper introduces the structure of hierarchical control strategies and common control approaches in the microgrid. In this paper, a novel enhanced EMS in islanding mode is presented for the hybrid energy storage system (HESS), comprising of two batteries and supercapacitors. A coordination control scheme is introduced at the primary level for the HESS. This will reduce the power stress on batteries, while improving the power quality.