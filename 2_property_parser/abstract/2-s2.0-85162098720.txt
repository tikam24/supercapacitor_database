When the capacity configuration of a hybrid energy storage system (HESS) is optimized considering the reliability of a wind turbine and photovoltaic generator (PVG), the sequential Monte Carlo method is typically adopted to simulate the normal operation and fault probability of wind turbines and PVG units. The capacity optimization configuration model of the HESS is constructed with the life cost cycle (LCC) as an objective and the loss of power supply probability (LPSP) as constraints. The variational mode decomposition is used to decompose the unbalanced power in the wind-PV microgrid. The maximum power of the optimized the battery bank and the supercapacitor bank are used to determine the frequency division point, and the high-frequency power and low-frequency power are respectively allocated to the supercapacitor bank and the battery bank. When the snake optimizer (SO) is used to solve the nonconvex capacity optimization configuration model of the HESS, poor accuracy and stability are significant problems. The opposition-based learning, adaptive weight factor, and LÃ©vy flight strategy are proposed in the SO's framework. Twenty-three test functions show that multi-strategy snake optimizer (MSO) significantly improves the accuracy and convergence speed compared with SO. Eleven optimization algorithms including MSO are used to solve the capacity optimization problem of the HESS. The results show that MSO is superior to other algorithms in performance and numerical accuracy. It can reduce the LCC 4.5% and ensure that the capacity of the HESS meets the load demand when the wind turbine and PVG are in a fault state.