Battery-supercapacitor hybrid energy storage systems can achieve better power and energy performances compared to their individual use. These hybrid systems require separate dc-dc converters, or at least one dc-dc converter for the supercapacitor bank, to connect them to the dc-link of the grid connecting inverter. However, the use of such dc-dc converters introduces additional cost and power losses. Therefore, the possibility of direct connection of energy storage systems, to the dc-link of a diode clamped 3-level inverter is investigated in this paper. Even though the proposed topology does not use dc-dc converters, a vector selection method is proposed to produce a similar control flexibility that is found in the separate dc-dc converter topology. The major issue with the proposed system is the imminent imbalance of the neutral point potential. A PWM technique with modified carriers is used to solve this problem. Simulations are carried out using MATLAB/SIMULINK to verify the efficacy of the proposed system. Â©2010 IEEE.