The design of carbon-based materials with a high mass density and large porosity has always been a challenging goal, since they fulfill the demands of next-generation supercapacitors and other electrochemical devices. We report a new class of high-density heteroatom-doped porous carbon that can be used as an aqueous-based supercapacitor material. The material was synthesized by an in situ dehalogenation reaction between a halogenated conjugated diene and nitrogen-containing nucleophiles. Under the given conditions, pyridinium salts can only continue to perform the dehalogenation if there is residue water remaining from the starting materials. The obtained carbon materials are highly doped by various heteroatoms, leading to high densities, abundant multimodal pores, and an excellent volumetric capacitive performance. Porous carbon tri-doped with nitrogen, phosphorous, and oxygen exhibits a high packing density (2.13 g cm −3 ) and an exceptional volumetric energy density (36.8 Wh L −1 ) in alkaline electrolytes, making it competitive to even some Ni-MH cells.