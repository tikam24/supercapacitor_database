A grid connected photovoltaic(PV) generation system with supercapacitor energy storage in a dc-coupled structure is proposed. The objective of this system is acquiring maximum power from PV arrays, keep the voltage of dc bus constant and supply the prescribed active and reactive power to power grid. An improved Perturbation and Observation (P&O) maximum power point tracking(MPPT) algorithm is applied to extract maximum power from PV arrays. The dc bus voltage is controlled via supercapacitor by charging and discharging. Constant active and reactive power control strategy is designed for the controller of DC/AC converter. Simulation results illustrate the performances obtained. Â© 2011 IEEE.