To recycle regenerative braking energy (RBE) while reducing demand charge in electrified railway, a co-phase power supply system with hybrid energy storage system (HESS) is implemented. However, the dynamical degradation characteristic of battery is necessary to be considered in optimal operation of HESS. A bi-level model considering battery degradation is proposed to obtain optimal sizing and operation of HESS. The proposed model includes a novel real-time energy management strategy (EMS) using average power as thresholds, to effectively reduce the demand charge and energy consumption charge. Thresholds are dynamically adjusted with the consideration of battery capacity degradation. A real measured load profile from Beijing-Shanghai high speed railway is studied. The results demonstrate that the proposed EMS performs better than previous EMS in cost saving. The dynamically adjusted thresholds of EMS are proved to be essential under the consideration of battery degradation. With the optimal sizing of the HESS, the traction substation can achieve 8.69% annual saving of demand charge and recycle 52.33% of the RBE. The results also show that a traction substation equipped with the HESS yields higher economic benefit than the energy storage systems equipped with only a battery or a supercapacitor.