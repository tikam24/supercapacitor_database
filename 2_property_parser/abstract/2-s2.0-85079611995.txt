Lithium-ion capacitors (LICs) are emerging as one of the most advanced hybrid energy storage devices. The key challenge in constructing a high-performance LIC is to couple an appropriate capacitive cathode with an intercalation anode, wherein they can match well in internal kinetics and capacity simultaneously. Here, we present a strategy for constructing an advanced LIC using a 3D N-doped hollow carbon microsphere (NHCM-12) anode combined with a hierarchical porous carbon (NHCM-A) cathode, which have both been prepared by the same polyimide precursor without any additional catalyst and template for the first time. Quantitative kinetics analysis and density functional theory (DFT) calculations are performed to demonstrate the surface-dominated Li-storage mechanism, revealing that pyrrolic-N and pyridinic-N are beneficial for stronger Li adsorption compared to quaternary-N. As expected, the fully assembled LIC (NHCM-12//NHCM-A) delivers a maximum energy density of 162 W h kg-1 and exhibits an outstanding lifespan over 5000 cycles with 86.2% capacity retention. Accordingly, our simultaneous manipulation of hierarchical N-doped porous carbon as both anode and cathode materials for energy storage using the same precursor may open an avenue for fabricating other ideal electrode structures.