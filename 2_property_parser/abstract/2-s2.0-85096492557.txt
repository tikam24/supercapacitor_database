The hybrid energy storage system (HESS) is a key component for smoothing fluctuation of power in micro-grids. An appropriate configuration of energy storage capacity for micro-grids can effectively improve the system economy. A new method for HESS capacity allocation in micro-grids based on the artificial bee colony (ABC) algorithm is proposed. The method proposed a power allocation strategy based on low pass filter (LPF) and fuzzy control. The strategy coordinates battery and supercapacitor operation and improves the battery operation environment. The fuzzy control takes the state of charge (SOC) of the battery and supercapacitors as the input and the correction coefficient of the time constant of the LPF filter as the output. The filter time constant of the LPF is timely adjusted, and the SOC of the battery and supercapacitor is stable within the limited range so that the overcharge and over-discharge of the battery can be avoided, and the lifetime of the battery is increased. This method also exploits sub-algorithms for supercapacitors and battery capacity optimization. Besides, the Monte Carlo simulation of the statistic model is implemented to eliminate the influence of uncertain factors such as wind speed, light intensity and temperature. The ABC algorithm is used to optimize the capacity allocation of hybrid energy storage, which avoids the problem of low accuracy and being easy to fall into the local optimal solution of the supercapacitors and battery capacity allocation sub-algorithms, and the optimal allocation of the capacity of the HESS is determined. By using this method, the number of supercapacitors required for the HESS is unchanged, and the number of battery is reduced from 75 to 65, which proves the rationality and economy of the proposed method.