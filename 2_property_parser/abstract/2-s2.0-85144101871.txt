The wide application of clean energy has promoted the development of microgrids. For direct current (DC) microgrids, power fluctuations are inevitable, because photovoltaics, wind power and other clean energy sources are very unstable, which will bring great trouble to DC microgrids. Hybrid energy storage systems (HESS) are an effective solution to suppress power fluctuations. For a HESS composed of battery and supercapacitor (SC), a low-pass filter is usually used to allocate energy and power requirements to each energy storage unit, but the filter constant of the filter cannot be dynamically adjusted to adapt to different situations. The low-pass filter compensation coefficient used in this paper will change with the state of charge and discharge and dynamically change and allocate different power requirements to the battery and SC according to the actual operating conditions of the HESS. The objective function of DC bus power fluctuation is established, and the optimized particle swarm algorithm (PSO) is used to obtain the output power coefficient of each energy storage unit. The output coefficient of the HESS control strategy has the characteristics of fast convergence speed and high computational efficiency in the optimization process, and it will not fall into the local optimal solution. Through the design experiment, the SC can withstand more high-frequency components, fully utilize the advantages of SC with fast response to power fluctuations, improve the performance of HESS and have great engineering application value.