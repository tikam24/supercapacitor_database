In this article, an uncertainty-based optimal control framework is proposed for the hybrid energy storage system (HESS), which allows for improved frequency regulation of a distributed microgrid. The control architecture updates the penalty factor of the controller quality function automatically and provides policy to the HESS, which consists of battery and ultracapacitor banks. The HESS supports a photovoltaic distributed energy resource during grid dynamics in the presence of frequency oscillations by managing the dc-link voltage. The penalty factor update is based on the sensitivity of the battery and ultracapacitor power contribution to the frequency change and is dynamically changing. These changing gains and penalty factors optimize the HESS output. The approach is generalized by making it compliant for extensions that include assimilation of affine, stochastic, linear time-variant, and trajectory-following nonlinear systems. A modified IEEE 123-bus distribution system is used as a test system to validate the proposed architecture and provide a quantitative comparison with the conventional frequency droop approach. It has been observed that the proposed architecture provides around 50% improvement frequency regulation when compared to optimal control.