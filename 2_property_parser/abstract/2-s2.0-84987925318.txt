In order to better utilize the configuration capacity of supercapacitor energy storage system used in urban rail system and extend the life of the supercapacitor, this paper presented a dynamic threshold control strategy based on the supercapacitor voltage and current. A further optimization was made on the service life of the supercapacitor. Firstly, the mathematical model of traction power supply network which combined trains and energy storage systems was established, to analyze the operating characteristics of the energy storage system in the traction power grid. Then the paper proposed an improved dynamic threshold control strategy, which can adjust the charge threshold based on the supercapacitor voltage and current, thus allocate the charging power reasonably for every device. In order to further reduce the voltage and temperature stress of the supercapacitor, and to extend the life of the supercapacitor, the paper proposed a dynamic threshold control strategy optimization algorithm based on genetic algorithm. The optimization model of the control strategy under the condition of multiple train operation was given. The optimal values of the control parameters were obtained through the genetic algorithm. The simulation results showed the effectiveness of the proposed control strategy.