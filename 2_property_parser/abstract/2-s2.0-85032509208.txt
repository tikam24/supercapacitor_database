The dual source trolleybus of a new model with battery and super capacitor energy storage system was designed. The related parameters of dynamical system were designed on the basis of theory deduction, and the simulation model was re-developed in ADVISOR software. Based on the analysis of work modes of the dual source trolleybus, an optimal control strategy based on Dynamic Programming was designed, which is aimed at reducing grid peaking power of on-line mode and energy consumption of off-line mode. In addition, the rule based control strategy has also been implemented and compared to the optimized control strategy. The results have demonstrated that the optimization techniques based on Dynamic Programming can make full use of the supercapacitors with high power and fast charging/discharging characteristics, and more effectively distribute the power between the power sources, improve the dynamic performance and economic performance of the trolleybus.