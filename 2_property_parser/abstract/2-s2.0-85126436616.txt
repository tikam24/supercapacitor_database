The large number of energy storage sources in the grid reduces the rotational inertia of the system, and the virtual synchronous generator (VSG) technology, as an effective way to solve this problem, has significant advantages in terms of its flexible and adjustable virtual inertia, but its flexible adjustment must meet the constraints of a variety of constraints. In this paper, we propose a flexible virtual inertia control strategy under different beam constraints, which takes into account the charge state of the energy storage unit and the adjustable power per unit time of the system. A two-end system model with optical storage VSG units is built. Finally, the effectiveness and practicality of the proposed virtual inertia control strategy under different constraints are verified by MATLAB/Simulink.