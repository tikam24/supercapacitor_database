The high penetration of the Renewable Energy Sources (RES) can create stability, reliability and power quality problems in the main electrical grid due to their stochastic nature. Microgrids can be analysed as a solution capable of guaranteeing a controlled injection of energy generated by the renewable energy technologies. The use of storage system in a MG plays an essential role in order to ensure energy balance and in maintaining high power quality. Due to the technical limitations of the currently available storage systems, it is necessary to use more than one storage technology to satisfy the requirement of microgrid applications. In order to satisfy the above constraints, this paper proposes the association of a supercapacitor (SC) and a lithium ion battery in a Hybrid Energy Storage System (HESS). A novel control strategy is adopted for the control of the HESS. Hierarchical control is used for the control of the inverter in islanding and grid connected mode. Self synchronization control ensures smooth transition between islanded and grid connected modes. Simulation of the system is carried out in MATLAB/Simulink.