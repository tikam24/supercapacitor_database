This paper proposes an energy management system designed to control the power flow in a hybrid microgrid composed of a 1 kWp PV array, a 1.2 kWp wind turbine, a 1.2 kW fuel cell and a 31.5 F / 250 V supercapacitor bank. The microgrid provides uninterrupted power supply of critical dc loads and it can operate in both, standalone or grid-connected modes. A power flow control strategy is proposed to provide real time power references for each renewable energy source according to the operational mode (grid-connected or standalone), the availability of energy resources (solar, wind and hydrogen stock) and the priority of dispatch. Experimental results obtained from several arrangements of power generation and load demand are presented and discussed.