Aiming at the selection method of optimal allocation for hybrid energy storage system consisting of lithium iron phosphate battery and supercapacitor, an improved wavelet packet decomposition theory was proposed to decompose the original output power of wind farm at multiple scales under the constraint of the fluctuation limit of wind power connected to the grid. The amplitude-frequency characteristics of wind power and the performance characteristics of HESS are comprehensively analyzed, and the power and capacity of hybrid energy storage are reasonably allocated. According to the state of charge (SOC) of energy storage, adaptive fuzzy control is used to optimize the power command of lithium battery and ultracapacitor, so as to reduce the capacity configuration of energy storage system and reduce the frequency of energy storage system. Combined with the annual measured data of a 100-megawatt wind farm in Inner Mongolia, simulation analysis was carried out on typical wind power output scenarios in spring, summer, autumn and winter. This method can effectively suppress the power fluctuation of the wind farm, reduce the demand for energy storage capacity configuration, extend the service life of the hybrid energy storage, and realize the long-term, stable and economic operation of the integrated wind storage system.