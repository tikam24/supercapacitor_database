In this paper, four different semi-active hybrid energy storage systems (HESSs), which use both supercapacitors (SCs) and batteries, are compared based on an electric city bus running the China Bus Driving Cycle (CBDC). The SC sizes of the different HESS topologies are optimized by using the dynamic programming (DP) approach, based on a dynamic degradation model of the LiFePO4 battery. The operation costs of different HESSs, including the electricity and the battery degradation costs over a whole CBDC, are minimized in the optimization process. Based on the DP results, near-optimal control strategies of different HESSs for on-line uses are proposed. Finally, the four HESS topologies are comprehensively compared from different aspects, including operation cost, initial cost, and DC bus voltage variation. Simulation results show that all HESS topologies have their merits and drawbacks, and can be used in different applications with different requirements. In addition, about 50% of the operation cost of the energy storage system is reduced by the semi-active HESSs when compared to the battery-only topology. Thus the effectiveness of adopting the SC in the HESS is verified.