High penetration of renewable energy sources has brought about large fluctuation and rapid intermittency to power systems with low inertia, which may cause instability issues. In this paper, a robust control algorithm with hybrid energy storage systems (ESS) is developed for frequency regulation problems in islanded microgrids. The proposed method has several advantages over existing methods. First, system frequency is stabilized in a robust way despite internal uncertainties and external disturbances. Second, the synchronous generator, battery and supercapacitor are scheduled to provide the instantaneous power mismatch cooperatively. Third, the SOC of hybrid ESS can be covered automatically after frequency deviation. The validity of the proposed robust control is verified by the simulation in the MATLAB environment.