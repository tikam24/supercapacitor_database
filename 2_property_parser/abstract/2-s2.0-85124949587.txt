Based on the comprehensive consideration of the temperature and SOC of lithium battery and the SOC of super-capacitor, the optimal particle swarm optimization algorithm is used to dynamically adjust the time constant of low-pass filter to realize the power distribution of hybrid energy storage. While ensuring the smooth output of lithium battery, the heat generation of lithium battery is reduced. In order to improve the response ability of supercapacitor in two extreme cases, the energy transfer method is used to protect the supercapacitor. The example analysis shows that the proposed power distribution strategy and supercapacitor over limit protection method can effectively improve the output of the two kinds of energy storage media.