This paper presents a 2-level controller managing a hybrid energy storage solution (HESS) for the grid integration of photovoltaic (PV) plants in distribution grids. The HESS is based on the interconnection of a lead-acid battery pack and a supercapacitor pack through a modular power electronics cabinet. The inclusion of the HESS into the PV plant –and not an state-of-the-art energy storage system based on a single technology–, is motivated by the diversity of technical requirements for the provision of the services of grid peak power shaving and PV output power ramp limitation. The 2-level controller ensures a synergistic exploitation of the two storage technologies aiming for an optimal service level of the HESS and minimum battery degradation. The higher level of the controller is based on a mathematical optimization problem that solves with the optimal schedule of the storage technologies for peak power shaving purposes. The power setpoints of this optimization are then complemented by a real time controller managing PV plant output ramp limitation. The HESS performance and associated controller has been proved effective through two case studies. The first one adopts a 6.6 MW PV plant including a HESS solution combining a 5.5 MWh and 2.64 MW lead-acid battery pack with a 0.25 MWh and 1.32 MW supercapacitor pack. The second one reports experimental data from an analogous scenario scaled down to kW level and using a laboratory scale prototype for the HESS. All in all, the hardware and software solutions proposed in this paper contribute to a feasible exploitation of multi-purpose energy storages targeting the needs of renewables' and distribution system operators.