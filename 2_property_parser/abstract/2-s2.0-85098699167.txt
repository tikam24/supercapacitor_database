This paper proposes a frequency-based energy management scheme (FEMS) for islanded operation of a microgrid (MG). The proposed FEMS uses a hybrid Energy Storage System (HESS), which is a combination of a battery ESS (BESS) and a Supercapacitor ESS (SESS). The BESS is used for continuously matching power generation and consumption, while SESS is used for fast dynamic power regulations like primary frequency regulations. The power consumption of the HVACs has a big share in the residential load profile, and they are thermostatically controlled to maintain the indoor temperature within comfortable limits. In this paper, a novel optimization problem is defined to optimally schedule the HVACs to change the MG load profile with the aim of reducing the required capacity of battery for the energy management of the islanded MG. In this regard, a novel battery capacity sizing methodology is proposed, which is more precise than previous methods, because it considers the effect of discharge duration on the capacity and voltage of the battery. The optimization results show that the optimal scheduling of the HVACs leads to considerable reduction in the battery capacity compared to common thermostatically controlled HVACs.