Heavily heteroatoms doped carbons are highly attractive for electrochemical energy storage and electrocatalysis applications. We report herein a versatile coordination chemistry strategy for the producing of B, N co-doped carbon nanosheets (BCN-Mg) with an ultrahigh doping level (15.26 % for N, 10.18 % for O, and 3.21 % for B) though pyrolysis of nitrogen-rich Mg-based complex in the presence of boric acid. In this protocol, hexamethylenetetramine, which acts as both carbon and nitrogen source, can easily complex with magnesium ion to form a nitrogen-rich Mg-based complex in aqueous solution due to the presence of plentiful amino groups with strong complexation capability. Benefiting from the ultrahigh doping level and moderate specific surface area of 428 m2 g−1, the as-obtained B, N co-doped carbon nanosheets display a high specific capacity of 130.7 mA h g−1 (at 0.1 A g−1), and good stability of 87.3 % after 10,000 cycles when serves as the cathode for aqueous Zn-ion hybrid capacitors. More importantly, change details of the N and B containing functional groups during the charge-discharge process have been fully evaluated by ex-situ X-ray photoelectron spectroscopy characterization technique and density functional theory calculations. This work not only offers a new way to develop B, N co-doped carbon nanosheets with an ultrahigh doping level but also shed some new insight on the roles of heteroatoms containing functional groups for electrochemical energy storage applications.