Hybrid storage system composed of battery energy storage systems (BESSs) and supercapacitors is a promising solution to mitigate the high frequency power fluctuations of pulsed power loads (PPLs) in medium voltage DC (MVDC) shipboard power systems. Due to the presence of multiple storage units, a power sharing algorithm needs to be considered within the energy management system (EMS) in the shipboard power system. In this paper, an optimal power flow problem is formulated for MVDC shipboard power systems with hybrid energy storage systems. Battery energy storage systems (BESSs) and conventional generation units are enhanced with virtual resistive droop controllers to share the steady-state power fluctuations. Supercapacitors are enhanced with virtual capacitive droop controllers to share the high frequency fluctuations in the load. The optimal flow accounts for minimizing the operational cost of the generation units in the shipboard power system considering the constraints of network, load balance, voltage profile, and power/energy limits. Second-order cone programming (SOCP) relaxation is used to approximate the nonconvexity of the optimal flow formulation and necessary conditions for global optimality of the solution are discussed. Results confirm the effectiveness of the proposed formulation in load support and managing the energy between storage units.