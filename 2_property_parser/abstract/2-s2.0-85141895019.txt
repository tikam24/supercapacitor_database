With the rapid development of renewable energy power generation and energy storage technology, emerging power sources and loads such as wind turbines, photovoltaic generator sets and electric vehicles have been accessed to the distribution network in large quantities, making it more difficult to manage the voltage in the distribution network. In this paper, the uncertainties faced by the distribution network in the new energy environment are analyzed. A new control method for regulating flexible load power, distributed energy storage charge and discharge power and distributed power reactive power output has been added. And a multi-objective opportunity constraint programming model for reactive voltage with the goal of minimizing line loss and voltage deviation is established for distribution network.