Traditional thin-film energy-storage devices consist of stacked layers of active films on two-dimensional substrates and do not exploit the third dimension. Fully three-dimensional thin-film devices would allow energy storage in bulk materials with arbitrary form factors and with mechanical properties unique to bulk materials such as compressibility. Here we show three-dimensional energy-storage devices based on layer-by-layer self-assembly of interdigitated thin films on the surface of an open-cell aerogel substrate. We demonstrate a reversibly compressible three-dimensional supercapacitor with carbon nanotube electrodes and a three-dimensional hybrid battery with a copper hexacyanoferrate ion intercalating cathode and a carbon nanotube anode. The three-dimensional supercapacitor shows stable operation over 400 cycles with a capacitance of 25â €‰Fâ €‰g â '1 and is fully functional even at compressions up to 75%. Our results demonstrate that layer-by-layer self-assembly inside aerogels is a rapid, precise and scalable route for building high-surface-area 3D thin-film devices.