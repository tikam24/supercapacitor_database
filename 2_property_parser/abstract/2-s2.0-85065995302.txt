In this paper a new control algorithm has been proposed to control the power flow of the utility grid which has been penetrated by renewable energy sources (RES). The proposed control algorithm ensures utility grid to undergo minimum power changes. The hybrid energy storage system consisting of high power density element such as super capacitor and high energy density element such as battery storage has been used to compensate the residual power. The proposed control algorithm has been implemented to the distribution static compensator (DSTATCOM) to achieve multiple goals, such as integrating photo voltaic (PV) to the utility grid, compensating the reactive power and current related power quality issues and the power flow balancing. The balancing of the energy flows and current related power quality issues have been compensated using a DSTATCOM. The proposed configuration of the system has been implemented in MATLAB/Simulink and the corresponding simulation results are being presented in the manuscript.