The integration of renewable energy source (RES) and energy storage systems (ESS) in microgrids has provided potential benefit to end users and system operators. However, intermittent issues of RES and high cost of ESS need to be placed under scrutiny for economic operation of microgrids. This paper presents a two-layer predictive energy management system (EMS) for microgrids with hybrid ESS consisting of batteries and supercapacitors. Incorporating degradation costs of the hybrid ESS with respect to the depth of charge and lifetime, long-term costs of batteries and supercapacitors are modeled and transformed to short-term costs related to real-time operation. In order to maintain high system robustness at minimum operational cost, a hierarchical dispatch model is proposed to determine the scheduling of utilities in microgrids within a finite time horizon, in which the upper layer EMS minimizes the total operational cost and the lower layer EMS eliminates fluctuations induced by forecast errors. Simulation studies demonstrate that different types of energy storages can be utilized at two control layers for multiple decision-making objectives. Scenarios incorporating different pricing schemes, prediction horizon lengths, and forecast accuracies also verify the effectiveness of the proposed EMS structure.