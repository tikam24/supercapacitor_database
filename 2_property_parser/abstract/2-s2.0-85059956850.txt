The fault current level is different in grid connected and islanded microgrid fault cases for the same relay. Also, the complex architecture of the contemporary microgrid resulting from dynamically connecting and disconnecting of distributed generators (DGs) are representing serious problems to protect the system. This paper presents a co-simulation platform for microgrid based on multiagent system utilizing a supercapacitor bank to enhance the resiliency of the protection scheme. The simulation software, embedded microcontrollers, and a real communication architecture are collective to perform the protection scheme platform. The DDS middleware is used to link between the hardware and software environments. This method does not need to change the relay settings at different configurations of the microgrid. The proposed solution does not incur additional costs to the system studied as the supercapacitor is already used to feed a pulsed load. The paper also proposes a coordination process between the relays with helping of the supercapacitor. Primary and back up protection were studied according to IEEE Std C37.112 to isolate the fault properly. This paper details the fault current that supplied by any DG to any point inside the network. The results showed that the co-simulation infrastructure introduces a high dependability design, analysis, and testing environment for cyber and physical data flow in the system.