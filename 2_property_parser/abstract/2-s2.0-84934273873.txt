Supercapacitor/battery hybrid energy storage system (HESS) is an effective way to suppress power fluctuation of photovoltaic power generation system during radiation change. First, the topology of HESS and its connection with photovoltaic system are analyzed. The power output reference of HESS is achieved by low-pass filtering with variable time constant. Second, to optimize HESS energy loss and SOC of supercapacitor, a linear weighted summation algorithm based on variable weights is proposed. The multi-objective optimization problem is constructed and solved to obtain current reference of supercapacitor and battery. Simulation and experiment results verified the proposed algorithms and control strategy.