In view of the active power fluctuation of large capacity photovoltaic (PV) power systems, based on a hybrid energy storage system consisting of supercapacitors and lithium-ion ferrous phosphate batteries, an active power hierarchical control strategy is formulated to optimize the output power of PV source. First, the overall structure of photovoltaic power station and the way of accessing the hybrid energy storage system are analyzed. Then, by considering the power grid needs, the exponential smoothing method is used to real-time update the reference values of output power to realize the first level control. The energy management strategy is put forward according to the storage characteristics of energy storage components and power throughput so as to realize the second level control of the hybrid energy storage system. In addition, an energy management strategy is put forward with supercapacitors as the principal part of charge and discharge. Finally, a control circuit of pulse width modulation (PWM) is designed. Programming results demonstrate the effectiveness of the proposed method. Â© 2013 State Grid Electric Power Research Institute Press.