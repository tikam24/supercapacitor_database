This paper proposes an improved methodology for the optimal sizing of small-scale microgrids conformed by photovoltaic (PV) generation systems and hybrid energy storage systems (batteries + supercapacitors). The methodology is based on a Mixed-Integer Linear Programming (MILP) formulation and includes a new way to take advantage of the aging model of the batteries to determine when these storage assets should be replaced. Moreover, the proposed sizing tool offers the possibility of including supercapacitors (SCs) in a microgrid's design to reduce battery degradation. The tool was put to test by sizing the microgrids for a hospital and a government building in Puerto Carre√±o, a non-interconnected area in Colombia. A comparison between the proposed methodology and another without considering battery degradation, along with a sensitivity analysis of the storage-acquisition cost parameter in this tool, revealed its usefulness for this kind of microgrid design.